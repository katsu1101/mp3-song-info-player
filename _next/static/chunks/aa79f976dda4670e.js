(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,72525,e=>{"use strict";var t=e.i(93432),a=e.i(91858),r=e.i(44397);class n{static fromBin(e,t=0){return new n(n.decode(e,t))}static decode(e,t=0){let a=new DataView(e.buffer,t);return`${a.getUint32(0,!0).toString(16)}-${a.getUint16(4,!0).toString(16)}-${a.getUint16(6,!0).toString(16)}-${a.getUint16(8).toString(16)}-${(0,r.uint8ArrayToHex)(e.subarray(t+10,t+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case n.AudioMedia.str:return"audio";case n.VideoMedia.str:return"video";case n.CommandMedia.str:return"command";case n.Degradable_JPEG_Media.str:return"degradable-jpeg";case n.FileTransferMedia.str:return"file-transfer";case n.BinaryMedia.str:return"binary"}}static encode(e){let t=new Uint8Array(16),a=new DataView(t.buffer);return a.setUint32(0,Number.parseInt(e.substring(0,8),16),!0),a.setUint16(4,Number.parseInt(e.substring(9,13),16),!0),a.setUint16(6,Number.parseInt(e.substring(14,18),16),!0),t.set((0,r.hexToUint8Array)(e.substring(19,23)),8),t.set((0,r.hexToUint8Array)(e.substring(24)),10),t}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return n.encode(this.str)}}n.HeaderObject=new n("75B22630-668E-11CF-A6D9-00AA0062CE6C"),n.DataObject=new n("75B22636-668E-11CF-A6D9-00AA0062CE6C"),n.SimpleIndexObject=new n("33000890-E5B1-11CF-89F4-00A0C90349CB"),n.IndexObject=new n("D6E229D3-35DA-11D1-9034-00A0C90349BE"),n.MediaObjectIndexObject=new n("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C"),n.TimecodeIndexObject=new n("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C"),n.FilePropertiesObject=new n("8CABDCA1-A947-11CF-8EE4-00C00C205365"),n.StreamPropertiesObject=new n("B7DC0791-A9B7-11CF-8EE6-00C00C205365"),n.HeaderExtensionObject=new n("5FBF03B5-A92E-11CF-8EE3-00C00C205365"),n.CodecListObject=new n("86D15240-311D-11D0-A3A4-00A0C90348F6"),n.ScriptCommandObject=new n("1EFB1A30-0B62-11D0-A39B-00A0C90348F6"),n.MarkerObject=new n("F487CD01-A951-11CF-8EE6-00C00C205365"),n.BitrateMutualExclusionObject=new n("D6E229DC-35DA-11D1-9034-00A0C90349BE"),n.ErrorCorrectionObject=new n("75B22635-668E-11CF-A6D9-00AA0062CE6C"),n.ContentDescriptionObject=new n("75B22633-668E-11CF-A6D9-00AA0062CE6C"),n.ExtendedContentDescriptionObject=new n("D2D0A440-E307-11D2-97F0-00A0C95EA850"),n.ContentBrandingObject=new n("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E"),n.StreamBitratePropertiesObject=new n("7BF875CE-468D-11D1-8D82-006097C9A2B2"),n.ContentEncryptionObject=new n("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E"),n.ExtendedContentEncryptionObject=new n("298AE614-2622-4C17-B935-DAE07EE9289C"),n.DigitalSignatureObject=new n("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E"),n.PaddingObject=new n("1806D474-CADF-4509-A4BA-9AABCB96AAE8"),n.ExtendedStreamPropertiesObject=new n("14E6A5CB-C672-4332-8399-A96952065B5A"),n.AdvancedMutualExclusionObject=new n("A08649CF-4775-4670-8A16-6E35357566CD"),n.GroupMutualExclusionObject=new n("D1465A40-5A79-4338-B71B-E36B8FD6C249"),n.StreamPrioritizationObject=new n("D4FED15B-88D3-454F-81F0-ED5C45999E24"),n.BandwidthSharingObject=new n("A69609E6-517B-11D2-B6AF-00C04FD908E9"),n.LanguageListObject=new n("7C4346A9-EFE0-4BFC-B229-393EDE415C85"),n.MetadataObject=new n("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA"),n.MetadataLibraryObject=new n("44231C94-9498-49D1-A141-1D134E457054"),n.IndexParametersObject=new n("D6E229DF-35DA-11D1-9034-00A0C90349BE"),n.MediaObjectIndexParametersObject=new n("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7"),n.TimecodeIndexParametersObject=new n("F55E496D-9797-4B5D-8C8B-604DFE9BFB24"),n.CompatibilityObject=new n("26F18B5D-4584-47EC-9F5F-0E651F0452C9"),n.AdvancedContentEncryptionObject=new n("43058533-6981-49E6-9B74-AD12CB86D58C"),n.AudioMedia=new n("F8699E40-5B4D-11CF-A8FD-00805F5C442B"),n.VideoMedia=new n("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B"),n.CommandMedia=new n("59DACFC0-59E6-11D0-A3AC-00A0C90348F6"),n.JFIF_Media=new n("B61BE100-5B4E-11CF-A8FD-00805F5C442B"),n.Degradable_JPEG_Media=new n("35907DE0-E415-11CF-A917-00805F5C442B"),n.FileTransferMedia=new n("91BD222C-F21C-497A-8B6D-5AA86BFC0185"),n.BinaryMedia=new n("3AFB65E2-47EF-40F2-AC2C-70A90D71D343"),n.ASF_Index_Placeholder_Object=new n("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");var i=e.i(81995),s=e.i(6568);function o(e){return s.stripNulls(s.decodeString(e,"utf-16le"))}let c=[o,d,function(e,t=0){return 1===u(e,t)},function(e,t=0){return i.UINT32_LE.get(e,t)},function(e,t=0){return i.UINT64_LE.get(e,t)},u,d];function d(e){return new Uint8Array(e)}function u(e,t=0){return i.UINT16_LE.get(e,t)}var l=e.i(1495),g=e.i(19102);class b extends(0,g.makeUnexpectedFileContentError)("ASF"){}let C={len:30,get:(e,t)=>({objectId:n.fromBin(e,t),objectSize:Number(i.UINT64_LE.get(e,t+16)),numberOfHeaderObjects:i.UINT32_LE.get(e,t+24)})},w={len:24,get:(e,t)=>({objectId:n.fromBin(e,t),objectSize:Number(i.UINT64_LE.get(e,t+16))})};class A{constructor(e){this.len=Number(e.objectSize)-w.len}postProcessTag(e,t,a,r){if("WM/Picture"===t)e.push({id:t,value:k.fromBuffer(r)});else{let n=c[a];if(!n)throw new b(`unexpected value headerType: ${a}`);e.push({id:t,value:n(r)})}}}class D extends A{get(e,t){return null}}class E extends A{get(e,t){return{fileId:n.fromBin(e,t),fileSize:i.UINT64_LE.get(e,t+16),creationDate:i.UINT64_LE.get(e,t+24),dataPacketsCount:i.UINT64_LE.get(e,t+32),playDuration:i.UINT64_LE.get(e,t+40),sendDuration:i.UINT64_LE.get(e,t+48),preroll:i.UINT64_LE.get(e,t+56),flags:{broadcast:s.getBit(e,t+64,24),seekable:s.getBit(e,t+64,25)},minimumDataPacketSize:i.UINT32_LE.get(e,t+68),maximumDataPacketSize:i.UINT32_LE.get(e,t+72),maximumBitrate:i.UINT32_LE.get(e,t+76)}}}E.guid=n.FilePropertiesObject;class B extends A{get(e,t){return{streamType:n.decodeMediaType(n.fromBin(e,t)),errorCorrectionType:n.fromBin(e,t+8)}}}B.guid=n.StreamPropertiesObject;class m{constructor(){this.len=22}get(e,t){let a=new DataView(e.buffer,t);return{reserved1:n.fromBin(e,t),reserved2:a.getUint16(16,!0),extensionDataSize:a.getUint16(18,!0)}}}m.guid=n.HeaderExtensionObject;let F={len:20,get:(e,t)=>({entryCount:new DataView(e.buffer,t).getUint16(16,!0)})};async function f(e){let t=await e.readNumber(i.UINT16_LE);return(await e.readToken(new i.StringType(2*t,"utf-16le"))).replace("\0","")}async function j(e){let t=await e.readToken(F),a=[];for(let r=0;r<t.entryCount;++r)a.push(await T(e));return a}async function p(e){let t=new Uint8Array(await e.readNumber(i.UINT16_LE));return await e.readBuffer(t),t}async function T(e){let t=await e.readNumber(i.UINT16_LE);return{type:{videoCodec:(1&t)==1,audioCodec:(2&t)==2},codecName:await f(e),description:await f(e),information:await p(e)}}class h extends A{get(e,t){let a=[],r=new DataView(e.buffer,t),n=10;for(let i=0;i<h.contentDescTags.length;++i){let s=r.getUint16(2*i,!0);if(s>0){let r=h.contentDescTags[i],c=n+s;a.push({id:r,value:o(e.subarray(t+n,t+c))}),n=c}}return a}}h.guid=n.ContentDescriptionObject,h.contentDescTags=["Title","Author","Copyright","Description","Rating"];class I extends A{get(e,t){let a=[],r=new DataView(e.buffer,t),n=r.getUint16(0,!0),i=2;for(let s=0;s<n;s+=1){let n=r.getUint16(i,!0);i+=2;let s=o(e.subarray(t+i,t+i+n));i+=n;let c=r.getUint16(i,!0);i+=2;let d=r.getUint16(i,!0);i+=2;let u=e.subarray(t+i,t+i+d);i+=d,this.postProcessTag(a,s,c,u)}return a}}I.guid=n.ExtendedContentDescriptionObject;class O extends A{get(e,t){let a=new DataView(e.buffer,t);return{startTime:i.UINT64_LE.get(e,t),endTime:i.UINT64_LE.get(e,t+8),dataBitrate:a.getInt32(12,!0),bufferSize:a.getInt32(16,!0),initialBufferFullness:a.getInt32(20,!0),alternateDataBitrate:a.getInt32(24,!0),alternateBufferSize:a.getInt32(28,!0),alternateInitialBufferFullness:a.getInt32(32,!0),maximumObjectSize:a.getInt32(36,!0),flags:{reliableFlag:s.getBit(e,t+40,0),seekableFlag:s.getBit(e,t+40,1),resendLiveCleanpointsFlag:s.getBit(e,t+40,2)},streamNumber:a.getInt16(42,!0),streamLanguageId:a.getInt16(44,!0),averageTimePerFrame:a.getInt32(52,!0),streamNameCount:a.getInt32(54,!0),payloadExtensionSystems:a.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}O.guid=n.ExtendedStreamPropertiesObject;class y extends A{get(e,t){let a=[],r=new DataView(e.buffer,t),n=r.getUint16(0,!0),i=2;for(let s=0;s<n;s+=1){i+=4;let n=r.getUint16(i,!0);i+=2;let s=r.getUint16(i,!0);i+=2;let c=r.getUint32(i,!0);i+=4;let d=o(e.subarray(t+i,t+i+n));i+=n;let u=e.subarray(t+i,t+i+c);i+=c,this.postProcessTag(a,d,s,u)}return a}}y.guid=n.MetadataObject;class U extends y{}U.guid=n.MetadataLibraryObject;class k{static fromBuffer(e){return new k(e.length).get(e,0)}constructor(e){this.len=e}get(e,t){let a=new DataView(e.buffer,t),r=a.getUint8(0),n=a.getInt32(1,!0),s=5;for(;0!==a.getUint16(s);)s+=2;let o=new i.StringType(s-5,"utf-16le").get(e,5);for(;0!==a.getUint16(s);)s+=2;let c=new i.StringType(s-5,"utf-16le").get(e,5);return{type:l.AttachedPictureType[r],format:o,description:c,size:n,data:e.slice(s+4)}}}var S=e.i(20881);let x=(0,t.default)("music-metadata:parser:ASF");class N extends S.BasicParser{async parse(){let e=await this.tokenizer.readToken(C);if(!e.objectId.equals(n.HeaderObject))throw new b(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(e){x("Error while parsing ASF: %s",e)}}async parseObjectHeader(e){let t;do{let e=await this.tokenizer.readToken(w);switch(x("header GUID=%s",e.objectId.str),e.objectId.str){case E.guid.str:{let t=await this.tokenizer.readToken(new E(e));this.metadata.setFormat("duration",Number(t.playDuration/BigInt(1e3))/1e4-Number(t.preroll)/1e3),this.metadata.setFormat("bitrate",t.maximumBitrate);break}case B.guid.str:{let t=await this.tokenizer.readToken(new B(e));this.metadata.setFormat("container",`ASF/${t.streamType}`);break}case m.guid.str:{let e=await this.tokenizer.readToken(new m);await this.parseExtensionObject(e.extensionDataSize);break}case h.guid.str:t=await this.tokenizer.readToken(new h(e)),await this.addTags(t);break;case I.guid.str:t=await this.tokenizer.readToken(new I(e)),await this.addTags(t);break;case n.CodecListObject.str:{let e=await j(this.tokenizer);e.forEach(e=>{this.metadata.addStreamInfo({type:e.type.videoCodec?a.TrackType.video:a.TrackType.audio,codecName:e.codecName})});let t=e.filter(e=>e.type.audioCodec).map(e=>e.codecName).join("/");this.metadata.setFormat("codec",t);break}case n.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(e.objectSize-w.len);break;case n.PaddingObject.str:x("Padding: %s bytes",e.objectSize-w.len),await this.tokenizer.ignore(e.objectSize-w.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${e.objectId.str}`),x("Ignore ASF-Object-GUID: %s",e.objectId.str),await this.tokenizer.readToken(new D(e))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:e,value:t})=>this.metadata.addTag("asf",e,t)))}async parseExtensionObject(e){do{let t=await this.tokenizer.readToken(w),a=t.objectSize-w.len;switch(t.objectId.str){case O.guid.str:await this.tokenizer.readToken(new O(t));break;case y.guid.str:{let e=await this.tokenizer.readToken(new y(t));await this.addTags(e);break}case U.guid.str:{let e=await this.tokenizer.readToken(new U(t));await this.addTags(e);break}case n.PaddingObject.str:case n.CompatibilityObject.str:case n.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(a);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${t.objectId.str}`),await this.tokenizer.readToken(new D(t))}e-=t.objectSize}while(e>0)}}e.s(["AsfParser",()=>N],72525)}]);
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,97042,e=>{e.v({backdrop:"AppShell-module-scss-module__zoei2q__backdrop",body:"AppShell-module-scss-module__zoei2q__body",drawerClose:"AppShell-module-scss-module__zoei2q__drawerClose",drawerHeader:"AppShell-module-scss-module__zoei2q__drawerHeader",drawerSub:"AppShell-module-scss-module__zoei2q__drawerSub",drawerTitle:"AppShell-module-scss-module__zoei2q__drawerTitle",header:"AppShell-module-scss-module__zoei2q__header",headerContent:"AppShell-module-scss-module__zoei2q__headerContent",headerInner:"AppShell-module-scss-module__zoei2q__headerInner",miniPlayerBar:"AppShell-module-scss-module__zoei2q__miniPlayerBar",playerInner:"AppShell-module-scss-module__zoei2q__playerInner",playerPane:"AppShell-module-scss-module__zoei2q__playerPane",playerSheet:"AppShell-module-scss-module__zoei2q__playerSheet",root:"AppShell-module-scss-module__zoei2q__root",scrollPane:"AppShell-module-scss-module__zoei2q__scrollPane",sheetBackdrop:"AppShell-module-scss-module__zoei2q__sheetBackdrop",sheetBody:"AppShell-module-scss-module__zoei2q__sheetBody",sheetClose:"AppShell-module-scss-module__zoei2q__sheetClose",sheetHandle:"AppShell-module-scss-module__zoei2q__sheetHandle",sheetHeader:"AppShell-module-scss-module__zoei2q__sheetHeader",sidebarPane:"AppShell-module-scss-module__zoei2q__sidebarPane",sidebarToggle:"AppShell-module-scss-module__zoei2q__sidebarToggle"})},44199,e=>{e.v({button:"SegmentedControl-module-scss-module__CQJBta__button",group:"SegmentedControl-module-scss-module__CQJBta__group",icon:"SegmentedControl-module-scss-module__CQJBta__icon",label:"SegmentedControl-module-scss-module__CQJBta__label",root:"SegmentedControl-module-scss-module__CQJBta__root",srOnly:"SegmentedControl-module-scss-module__CQJBta__srOnly",text:"SegmentedControl-module-scss-module__CQJBta__text"})},20413,e=>{e.v({knob:"ToggleControl-module-scss-module__EbH3cW__knob",toggle:"ToggleControl-module-scss-module__EbH3cW__toggle"})},10305,e=>{e.v({fallback:"ArtworkSquare-module-scss-module__uT8OGa__fallback",glyph:"ArtworkSquare-module-scss-module__uT8OGa__glyph",img:"ArtworkSquare-module-scss-module__uT8OGa__img"})},45223,e=>{e.v({artworkFrame:"NowPlayingPanel-module-scss-module__5lgbBW__artworkFrame",lyricsBox:"NowPlayingPanel-module-scss-module__5lgbBW__lyricsBox",lyricsStandalone:"NowPlayingPanel-module-scss-module__5lgbBW__lyricsStandalone",lyricsStandaloneBox:"NowPlayingPanel-module-scss-module__5lgbBW__lyricsStandaloneBox",lyricsText:"NowPlayingPanel-module-scss-module__5lgbBW__lyricsText",overlay:"NowPlayingPanel-module-scss-module__5lgbBW__overlay",panelGrid:"NowPlayingPanel-module-scss-module__5lgbBW__panelGrid",panelRoot:"NowPlayingPanel-module-scss-module__5lgbBW__panelRoot"})},40439,e=>{e.v({isPaused:"NowPlayingPulse-module-scss-module__LD3xHG__isPaused",npRing:"NowPlayingPulse-module-scss-module__LD3xHG__npRing",npRing1:"NowPlayingPulse-module-scss-module__LD3xHG__npRing1",npRing2:"NowPlayingPulse-module-scss-module__LD3xHG__npRing2"})},99369,e=>{e.v({albumHeader:"TrackList-module-scss-module__CtazdW__albumHeader",albumHeaderText:"TrackList-module-scss-module__CtazdW__albumHeaderText",albumMeta:"TrackList-module-scss-module__CtazdW__albumMeta",albumSection:"TrackList-module-scss-module__CtazdW__albumSection",albumTitle:"TrackList-module-scss-module__CtazdW__albumTitle",albumTracks:"TrackList-module-scss-module__CtazdW__albumTracks",artBox:"TrackList-module-scss-module__CtazdW__artBox",artInner:"TrackList-module-scss-module__CtazdW__artInner",colAction:"TrackList-module-scss-module__CtazdW__colAction",colArt:"TrackList-module-scss-module__CtazdW__colArt",colNo:"TrackList-module-scss-module__CtazdW__colNo",colOrig:"TrackList-module-scss-module__CtazdW__colOrig",colPath:"TrackList-module-scss-module__CtazdW__colPath",colTitle:"TrackList-module-scss-module__CtazdW__colTitle",colYm:"TrackList-module-scss-module__CtazdW__colYm",headerRow:"TrackList-module-scss-module__CtazdW__headerRow",item:"TrackList-module-scss-module__CtazdW__item",list:"TrackList-module-scss-module__CtazdW__list",rowButton:"TrackList-module-scss-module__CtazdW__rowButton",trackList:"TrackList-module-scss-module__CtazdW__trackList"})},97967,(e,t,r)=>{},52683,e=>{"use strict";var t=e.i(73018),r=e.i(327),l=e.i(97042);function a({header:e,sidebar:a,main:i,renderPlayer:n}){let s=(0,r.useId)(),[o,d]=(0,r.useState)(!1),[u,c]=(0,r.useState)(!1),m=(0,r.useCallback)(()=>d(!1),[]),f=(0,r.useCallback)(()=>d(e=>!e),[]),p=(0,r.useCallback)(()=>c(!0),[]),h=(0,r.useCallback)(()=>c(!1),[]);(0,r.useEffect)(()=>{let e=e=>{if("Escape"===e.key){if(u)return h();if(o)return m()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[u,o,h,m]),(0,r.useEffect)(()=>{if(!(u||o))return;let e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}},[u,o]);let y=(0,r.useMemo)(()=>o?"true":"false",[o]),g=(0,r.useMemo)(()=>u?"true":"false",[u]);return(0,t.jsxs)("div",{className:l.default.root,children:[(0,t.jsx)("div",{className:l.default.header,children:(0,t.jsxs)("div",{className:l.default.headerInner,children:[(0,t.jsx)("button",{type:"button",className:l.default.sidebarToggle,"aria-controls":s,"aria-expanded":o,onClick:f,children:"â˜°"}),(0,t.jsx)("div",{className:l.default.headerContent,children:e})]})}),(0,t.jsx)("div",{className:l.default.backdrop,"data-open":y,onClick:m,"aria-hidden":"true"}),(0,t.jsx)("div",{className:l.default.sheetBackdrop,"data-open":g,onClick:h,"aria-hidden":"true"}),(0,t.jsxs)("div",{className:l.default.body,children:[(0,t.jsxs)("aside",{id:"sidebar-drawer",className:l.default.sidebarPane,"data-open":o?"true":"false",children:[(0,t.jsxs)("div",{className:l.default.drawerHeader,children:[(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:l.default.drawerTitle,children:"ãƒ¡ãƒ‹ãƒ¥ãƒ¼"})}),(0,t.jsx)("button",{type:"button",className:l.default.drawerClose,onClick:()=>d(!1),"aria-label":"ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‰ã˜ã‚‹",children:"âœ•"})]}),a({closeSidebar:m})]}),(0,t.jsx)("main",{className:`${l.default.scrollPane} ${l.default.mainPane} scrollbar ml-3`,children:i}),(0,t.jsx)("aside",{className:`${l.default.scrollPane} ${l.default.playerPane} scrollbar`,children:(0,t.jsx)("div",{className:l.default.playerInner,children:n("full")})})]}),(0,t.jsx)("div",{className:l.default.miniPlayerBar,role:"button",tabIndex:0,onClick:p,onKeyDown:e=>{"Enter"===e.key&&p()},children:n("mini")}),(0,t.jsxs)("section",{className:l.default.playerSheet,"data-open":g,role:"dialog","aria-modal":"true",children:[(0,t.jsxs)("div",{className:l.default.sheetHeader,children:[(0,t.jsx)("div",{className:l.default.sheetHandle}),(0,t.jsx)("button",{type:"button",className:l.default.sheetClose,onClick:h,children:"é–‰ã˜ã‚‹"})]}),(0,t.jsx)("div",{className:l.default.sheetBody,children:n("full2")})]})]})}var i=e.i(80389),n=e.i(44199);function s(e){let{label:r,value:l,options:a,onChangeAction:i,ariaLabel:s,align:o="end",stackOnNarrow:d=!0,iconOnly:u=!1}=e,c=s??r??"segmented-control";return(0,t.jsxs)("div",{className:n.default.root,"data-align":o,"data-stack":d?"1":"0",children:[r?(0,t.jsx)("span",{className:n.default.label,children:r}):null,(0,t.jsx)("div",{className:n.default.group,role:"group","aria-label":c,children:a.map(e=>{let r=e.value===l;return(0,t.jsxs)("button",{type:"button",className:n.default.button,"aria-pressed":r,"aria-label":e.label,title:e.label,disabled:!!e.disabled,onClick:()=>{e.disabled||i(e.value)},children:[e.icon?(0,t.jsx)("span",{className:n.default.icon,"aria-hidden":!0,children:e.icon}):null,u?null:(0,t.jsx)("span",{className:n.default.text,children:e.label}),u?(0,t.jsx)("span",{className:n.default.srOnly,children:e.label}):null]},String(e.value))})})]})}var o=e.i(20413);function d(e){let{checked:r,onChangeAction:l,disabled:a=!1,ariaLabel:i}=e;return(0,t.jsx)("button",{type:"button",className:o.default.toggle,"aria-label":i,"aria-pressed":r,disabled:a,onClick:()=>{a||l(!r)},children:(0,t.jsx)("span",{className:o.default.knob,"aria-hidden":!0})})}let u=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},c=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var m={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:l=2,absoluteStrokeWidth:a,className:i="",children:n,iconNode:s,...o},d)=>(0,r.createElement)("svg",{ref:d,...m,width:t,height:t,stroke:e,strokeWidth:a?24*Number(l)/Number(t):l,className:c("lucide",i),...!n&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(o)&&{"aria-hidden":"true"},...o},[...s.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(n)?n:[n]])),p=(e,t)=>{let l=(0,r.forwardRef)(({className:l,...a},i)=>(0,r.createElement)(f,{ref:i,iconNode:t,className:c(`lucide-${u(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,l),...a}));return l.displayName=u(e),l},h=p("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),y=p("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]),g=[{value:"grid",label:"ã‚°ãƒªãƒƒãƒ‰",icon:(0,t.jsx)(h,{size:18,"aria-hidden":!0})},{value:"list",label:"ãƒªã‚¹ãƒˆ",icon:(0,t.jsx)(y,{size:18,"aria-hidden":!0})}],w=[{value:"sm",label:"å°",icon:(0,t.jsx)(t.Fragment,{children:"å°"})},{value:"md",label:"ä¸­",icon:(0,t.jsx)(t.Fragment,{children:"ä¸­"})},{value:"lg",label:"å¤§",icon:(0,t.jsx)(t.Fragment,{children:"å¤§"})}];function b({state:e,commands:l,closeSidebar:a}){let{settings:n,toggleSetting:o,setSetting:u}=(0,i.useSettings)(),c=(0,r.useCallback)(async e=>{e&&(await e(),a())},[a]),m=(0,r.useCallback)(e=>u("ui.trackListViewMode",e),[u]),f=(0,r.useCallback)(e=>{u("ui.trackGridSize",e),u("ui.trackListViewMode","grid")},[u]);return(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsx)(v,{onClick:()=>void c(l.pickFolder),children:"ãƒ•ã‚©ãƒ«ãƒ€ã‚’é¸ã¶"}),e.savedHandle&&e.needsReconnect?(0,t.jsx)(v,{onClick:()=>void c(l.reconnect),variant:"ghost",children:"å†æŽ¥ç¶š"}):null,(0,t.jsx)(x,{children:"å†ç”Ÿ"}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 px-1",children:[(0,t.jsx)("span",{className:"text-sm opacity-90",children:"é€£ç¶šå†ç”Ÿ"}),(0,t.jsx)(d,{ariaLabel:"é€£ç¶šå†ç”Ÿ",checked:n.playback.continuous,onChangeAction:()=>{o("playback.continuous"),a()}})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 px-1",children:[(0,t.jsx)("span",{className:"text-sm opacity-90",children:"ã‚·ãƒ£ãƒƒãƒ•ãƒ«"}),(0,t.jsx)(d,{ariaLabel:"ã‚·ãƒ£ãƒƒãƒ•ãƒ«",checked:n.playback.shuffle,onChangeAction:()=>{l.stopPlayback(),o("playback.shuffle"),a()}})]}),(0,t.jsx)(x,{children:"è¡¨ç¤º"}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 px-1",children:[(0,t.jsx)("span",{className:"text-sm opacity-90",children:"ã‚¢ãƒ«ãƒãƒ "}),(0,t.jsx)(d,{ariaLabel:"ã‚¢ãƒ«ãƒãƒ ",checked:n.ui.showAlbums,onChangeAction:()=>{o("ui.showAlbums"),a()}})]}),(0,t.jsx)(s,{iconOnly:!0,label:"ãƒ¢ãƒ¼ãƒ‰",value:n.ui.trackListViewMode,options:g,onChangeAction:e=>{m(e),a()}}),(0,t.jsx)(s,{iconOnly:!0,label:"ã‚µã‚¤ã‚º",value:n.ui.trackGridSize,options:w,onChangeAction:e=>{f(e),a()}}),e.savedHandle?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x,{children:"å±é™ºæ“ä½œ"}),(0,t.jsx)(v,{onClick:()=>void(window.confirm("ä¿å­˜ã—ã¦ã„ã‚‹æƒ…å ±ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ")&&(l.forget(),a())),variant:"danger",children:"ãƒªã‚»ãƒƒãƒˆ"})]}):null]})}function x({children:e}){return(0,t.jsx)("div",{className:"text-sm font-extrabold opacity-90",children:e})}function v(e){let r=e.variant??"normal",l="text-left px-3 py-2 rounded-lg border transition",a="danger"===r?`${l} bg-transparent border-[color:rgba(255,99,99,0.45)] text-[color:rgb(255,170,170)] hover:bg-[color:rgba(255,99,99,0.10)]`:"ghost"===r?`${l} bg-transparent border-[color:var(--panel-border)] text-[color:var(--foreground)] hover:bg-[color:var(--panel-hover)]`:`${l} bg-[color:var(--panel)] border-[color:var(--panel-border)] text-[color:var(--foreground)] hover:bg-[color:var(--panel-hover)]`;return(0,t.jsx)("button",{type:"button",className:a,onClick:e.onClick,children:e.children})}function k(e){let{title:r,folderName:l}=e;return(0,t.jsx)("header",{style:{marginTop:8,padding:"10px 12px",borderRadius:14,border:"1px solid var(--panel-border)",background:"var(--panel)",color:"var(--foreground)"},children:(0,t.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"baseline",gap:10,minWidth:220,flex:"1 1 auto"},children:[(0,t.jsx)("div",{style:{fontSize:20,fontWeight:900,lineHeight:1.1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:320},title:r,children:r}),(0,t.jsx)("span",{style:{fontSize:12,color:"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:360},title:l,children:l?`é¸æŠžä¸­: ${l}`:"æœªé¸æŠž"})]})})})}var _=e.i(83157),j=e.i(10305);let A=e=>{let{url:l,size:a,radius:i=12,fallbackText:n,seed:s}=e,[o,d]=(0,r.useState)(!1),u=!l||o,c=(0,r.useMemo)(()=>(e=>{let t=(e??"").trim();if(!t)return"â™ª";let r=t.replace(/^[\s\u3000\[\](){}<>ã€Œã€ã€Žã€ã€ã€‘ã€”ã€•ï¼»ï¼½ã€ˆã€‰ã€Šã€‹Â»â€œâ€â€˜â€™\uFF08\uFF09\uFF5B\uFF5D\u3014-\u301B\u301D\u301F\uFF5F\uFF60â€“â€”â€-â€’~ã€œãƒ»â€¦:;'"!ï¼?ï¼Ÿ,ï¼Œ.ã€‚\/\\|]+/u,"").trim();if(!r)return"â™ª";let l=r.match(/^[0-9ï¼-ï¼™]+/);if(l?.[0])return l[0];let a=r.match(/^[A-Za-zï¼¡-ï¼ºï½-ï½š]+/);if(a?.[0])return a[0].slice(0,3);try{let e=new Intl.Segmenter("ja",{granularity:"grapheme"}),t=e.segment(r)[Symbol.iterator]().next().value?.segment;if("string"==typeof t&&t)return t}catch{}return Array.from(r)[0]??"â™ª"})(n??s??null),[n,s]),m=(0,r.useMemo)(()=>{var e=(s??n??c).trim()||c;let t=0;for(let r=0;r<e.length;r+=1)t=31*t+e.charCodeAt(r)>>>0;return t%360},[s,n,c]),f={width:a??"100%",height:a??"100%",borderRadius:i,"--hue":m,objectFit:"cover",objectPosition:"top"};if(u){let e,r=1===(e=Math.max(1,Math.min(6,c.length)))?56:2===e?48:3===e?40:4===e?34:30;return(0,t.jsx)("div",{className:j.default.fallback,style:f,"aria-label":"artwork placeholder",children:(0,t.jsxs)("svg",{viewBox:"0 0 100 100",width:"100%",height:"100%","aria-hidden":!0,style:{display:"block"},children:[(0,t.jsxs)("defs",{children:[(0,t.jsxs)("radialGradient",{cx:"20%",cy:"10%",r:"80%",children:[(0,t.jsx)("stop",{offset:"0%",stopColor:`hsl(${m} 90% 65% / 0.90)`}),(0,t.jsx)("stop",{offset:"70%",stopColor:"transparent"})]}),(0,t.jsxs)("radialGradient",{cx:"90%",cy:"85%",r:"90%",children:[(0,t.jsx)("stop",{offset:"0%",stopColor:`hsl(${(m+60)%360} 90% 55% / 0.85)`}),(0,t.jsx)("stop",{offset:"75%",stopColor:"transparent"})]})]}),(0,t.jsx)("rect",{width:"100",height:"100",fill:"url(#g1)"}),(0,t.jsx)("rect",{width:"100",height:"100",fill:"url(#g2)"}),(0,t.jsx)("rect",{width:"100",height:"100",fill:"rgba(255,255,255,0.10)"}),(0,t.jsx)("text",{x:"50",y:"52",textAnchor:"middle",dominantBaseline:"middle",fontSize:r,fontWeight:900,fill:"rgba(255,255,255,0.96)",style:{paintOrder:"stroke",stroke:"rgba(0,0,0,0.25)",strokeWidth:2},children:c})]})})}return(0,t.jsx)("img",{className:j.default.img,src:l,alt:"",...a?{width:a,height:a}:{},style:f,onError:()=>d(!0),loading:"lazy",decoding:"async"})},N=(e,t,r)=>e<t?t:e>r?r:e,C=e=>{let t=e.lastIndexOf("/");return t>=0?e.slice(0,t):""},S=e=>{let t=e.replaceAll("\\","/");return t.split("/").pop()??t},T=p("fast-forward",[["path",{d:"M12 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 12 18z",key:"b19h5q"}],["path",{d:"M2 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 2 18z",key:"h7h5ge"}]]),L=p("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]),I=p("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),P=p("rewind",[["path",{d:"M12 6a2 2 0 0 0-3.414-1.414l-6 6a2 2 0 0 0 0 2.828l6 6A2 2 0 0 0 12 18z",key:"2a1g8i"}],["path",{d:"M22 6a2 2 0 0 0-3.414-1.414l-6 6a2 2 0 0 0 0 2.828l6 6A2 2 0 0 0 22 18z",key:"rg3s36"}]]),B=p("skip-back",[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]]),E=p("skip-forward",[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]]);var z=e.i(45223);function H(e){let{nowPlayingID:l,trackViews:a,albumViews:i,audioRef:n,commands:s,isPlaying:o,metaByPath:d}=e,u=(0,r.useRef)(null),c=(0,r.useMemo)(()=>l?a.find(e=>e.item.id===l)??null:null,[l,a]),m=c?.displayTitle??"",f=c?.item.path,p=f?S(f):"â€”",h=f?C(f):"",y=!!c?.item,g=async()=>{if(!y)return;let e=n.current;if(e){if(e.paused||e.ended){try{await e.play()}catch{}return}e.pause()}},w=(0,r.useMemo)(()=>a.find(e=>e.item.id===l)??null,[a,l]),b=(0,r.useMemo)(()=>{let e=new Map;for(let t of i??[])for(let r of t.tracks){let l=r.t.item.id;e.set(l,t)}return e},[i]),x=(0,r.useMemo)(()=>{if(!w)return null;let e=w.item.id;return b.get(e)??null},[w,b]),v=(0,r.useMemo)(()=>{if(!x||!w)return null;let e=w.item.id,t=x.tracks.findIndex(t=>t.t.item.id===e);return t<0?null:{indexInAlbum:t+1,totalInAlbum:x.tracks.length}},[x,w]),k=w?.item.path??"",_=c?.lyrics??(k?d[k]?.lyrics??"":"")??"",j=_.trim().length>0;(e=>{let{audioRef:t,scrollRef:l,enabled:a,pauseMs:i=2500,useAnimationFrame:n=!1,deadZoneRatio:s=.15}=e,o=(0,r.useRef)(0),d=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=l.current;if(!e)return;let t=()=>{o.current=Date.now()+i};return e.addEventListener("wheel",t,{passive:!0}),e.addEventListener("touchstart",t,{passive:!0}),e.addEventListener("pointerdown",t,{passive:!0}),()=>{e.removeEventListener("wheel",t),e.removeEventListener("touchstart",t),e.removeEventListener("pointerdown",t)}},[l,i]),(0,r.useEffect)(()=>{let e=t.current,r=l.current;if(!e||!r||!a)return;let i=()=>{if(Date.now()<o.current)return;let t=e.duration;if(!Number.isFinite(t)||t<=0)return;let l=r.scrollHeight-r.clientHeight;if(l<=0)return;let a=N(e.currentTime/t,0,1),i=N(s,0,.49);r.scrollTop=(a<=i?0:a>=1-i?1:(a-i)/(1-2*i))*l};if(n){let e=()=>{i(),d.current=requestAnimationFrame(e)};return d.current=requestAnimationFrame(e),()=>void(null!==d.current&&(cancelAnimationFrame(d.current),d.current=null))}let u=()=>i();return e.addEventListener("timeupdate",u),e.addEventListener("seeked",u),()=>{e.removeEventListener("timeupdate",u),e.removeEventListener("seeked",u)}},[t,l,a,n,s])})({audioRef:n,scrollRef:u,enabled:j,pauseMs:2500,useAnimationFrame:!1});let H=e.variant??"full",M=!!c?.artworkUrl,D=j&&M;return"mini"===H?(0,t.jsxs)("div",{style:{height:"100%",width:"100%",display:"flex",alignItems:"stretch",minWidth:0},children:[(0,t.jsx)("div",{style:{height:"100%",aspectRatio:"1 / 1",borderRight:"1px solid var(--panel-border)",background:"var(--panel)",display:"grid",placeItems:"center"},children:(0,t.jsx)(A,{url:c?.artworkUrl,fallbackText:c?.displayTitle??"",seed:c?.displayTitle??""})}),(0,t.jsxs)("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",justifyContent:"space-between",padding:"10px 12px",gap:8},children:[(0,t.jsx)("div",{style:{fontSize:14,fontWeight:900,lineHeight:1.2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"var(--foreground)"},title:m,children:m}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,justifyContent:"flex-end"},children:[(0,t.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),s.playPrev()},disabled:!y,style:W(!y),title:"å‰ã¸",children:(0,t.jsx)(B,{size:20,strokeWidth:2.5,"aria-hidden":!0})}),(0,t.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),s.playRewind()},disabled:!y,style:W(!y),title:"å·»ãæˆ»ã—",children:(0,t.jsx)(P,{})}),(0,t.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),g()},disabled:!y,style:W(!y),title:o?"ä¸€æ™‚åœæ­¢":"å†ç”Ÿ",children:o?(0,t.jsx)(L,{size:20,strokeWidth:2.5,"aria-hidden":!0}):(0,t.jsx)(I,{size:20,strokeWidth:2.5,"aria-hidden":!0})}),(0,t.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),s.playForward()},disabled:!y,style:W(!y),title:"å…ˆé€ã‚Š",children:(0,t.jsx)(T,{})}),(0,t.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),s.playNext()},disabled:!y,style:W(!y),title:"æ¬¡ã¸",children:(0,t.jsx)(E,{size:20,strokeWidth:2.5,"aria-hidden":!0})})]})]})]}):(0,t.jsxs)("section",{className:z.default.panelRoot,children:[(0,t.jsxs)("div",{className:z.default.panelGrid,children:[x?(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"44px minmax(0,1fr)",gap:10,alignItems:"center"},children:[(0,t.jsx)(A,{url:x.artworkUrl,radius:12,fallbackText:x.title,seed:x.title}),(0,t.jsxs)("div",{style:{minWidth:0},children:[(0,t.jsx)("div",{style:{fontWeight:900,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:x.title}),(0,t.jsx)("div",{style:{opacity:.7,fontSize:13},children:v?`${v.indexInAlbum} / ${v.totalInAlbum}`:`${x.trackCount} æ›²`})]})]}):null,(0,t.jsx)("div",{className:z.default.artworkFrame,"data-has-lyrics":j?"1":"0",style:{maxWidth:280},children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A,{url:c?.artworkUrl,fallbackText:c?.displayTitle??"",seed:c?.displayTitle??""}),D?(0,t.jsx)("div",{className:z.default.overlay,children:(0,t.jsx)("div",{className:z.default.lyricsBox,ref:u,"aria-label":"æ­Œè©ž",children:(0,t.jsx)("div",{className:z.default.lyricsText,children:_})})}):null]}):j?(0,t.jsx)("div",{className:z.default.lyricsStandaloneInFrame,ref:u,"aria-label":"æ­Œè©ž",children:(0,t.jsx)("div",{className:z.default.lyricsText,children:_})}):(0,t.jsx)(A,{url:null,fallbackText:c?.displayTitle??"",seed:c?.displayTitle??""})})]}),(0,t.jsxs)("div",{style:{marginTop:10,display:"flex",gap:10,minWidth:0,flex:1,flexDirection:"column",justifyContent:"space-between",padding:"10px 12px"},children:[(0,t.jsx)("div",{style:{minWidth:0,fontSize:16,fontWeight:900,lineHeight:1.2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:m,children:m}),(0,t.jsxs)("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:10},children:[(0,t.jsx)("button",{type:"button",onClick:()=>void s.playPrev(),disabled:!y,style:F(!y),title:"å‰ã¸ï¼ˆâ†‘ï¼‰",children:(0,t.jsx)(B,{size:20,strokeWidth:2.5,"aria-hidden":!0})}),(0,t.jsx)("button",{type:"button",onClick:()=>void s.playRewind(),disabled:!y,style:W(!y),title:"å·»ãæˆ»ã—ï¼ˆâ†ï¼‰",children:(0,t.jsx)(P,{})}),(0,t.jsx)("button",{type:"button",onClick:()=>void g(),disabled:!y,style:F(!y),title:o?"ä¸€æ™‚åœæ­¢":"å†ç”Ÿ",children:o?(0,t.jsx)(L,{size:20,strokeWidth:2.5,"aria-hidden":!0}):(0,t.jsx)(I,{size:20,strokeWidth:2.5,"aria-hidden":!0})}),(0,t.jsx)("button",{type:"button",onClick:()=>void s.playForward(),disabled:!y,style:W(!y),title:"å…ˆé€ã‚Šï¼ˆâ†’ï¼‰",children:(0,t.jsx)(T,{})}),(0,t.jsx)("button",{type:"button",onClick:()=>void s.playNext(),disabled:!y,style:F(!y),title:"æ¬¡ã¸ï¼ˆâ†“ï¼‰",children:(0,t.jsx)(E,{size:20,strokeWidth:2.5,"aria-hidden":!0})})]})]}),"full"===H?(0,t.jsx)("div",{style:{marginTop:10},children:(0,t.jsx)("audio",{ref:n,controls:!0,preload:"none",style:{width:"100%"}})}):null,(0,t.jsxs)("div",{style:{marginTop:12,display:"grid",gap:6},children:[(0,t.jsx)(R,{label:"ã‚¢ãƒ«ãƒãƒ ",value:c?.albumTitle??"â€”"}),(0,t.jsx)(R,{label:"ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ",value:c?.originalArtist??"â€”"}),(0,t.jsx)(R,{label:"ãƒ•ã‚¡ã‚¤ãƒ«",value:p}),h?(0,t.jsx)(R,{label:"ãƒ•ã‚©ãƒ«ãƒ€",value:h}):null]}),f?(0,t.jsxs)("details",{style:{marginTop:10},children:[(0,t.jsx)("summary",{style:{cursor:"pointer",fontSize:12,opacity:.7},children:"ãƒ‘ã‚¹"}),(0,t.jsx)("div",{style:{fontSize:11,opacity:.6,marginTop:6,wordBreak:"break-all"},children:f})]}):null]})}function R(e){let{label:r,value:l}=e;return(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"72px 1fr",gap:10,minWidth:0},children:[(0,t.jsx)("div",{style:{fontSize:11,opacity:.55,whiteSpace:"nowrap"},children:r}),(0,t.jsx)("div",{style:{fontSize:12,opacity:.85,minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:l,children:l})]})}function F(e){return{width:44,height:34,borderRadius:999,border:e?"1px solid var(--panel-border)":"1px solid rgba(0,0,0,0.18)",background:e?"var(--panel)":"rgba(0,0,0,0.06)",color:e?"rgba(0,0,0,0.35)":"var(--foreground)",fontWeight:900,opacity:1,cursor:e?"not-allowed":"pointer",display:"grid",placeItems:"center",lineHeight:1}}function W(e){return{width:40,height:32,borderRadius:999,border:"1px solid var(--panel-border)",background:"var(--panel)",color:"var(--foreground)",fontWeight:900,opacity:e?.45:1,cursor:e?"not-allowed":"pointer",display:"grid",placeItems:"center",lineHeight:1}}function M({state:e,commands:r}){let l=!!(e.savedHandle&&e.needsReconnect);return(0,t.jsxs)("div",{style:{display:"grid",placeItems:"center",padding:16},children:[l?(0,t.jsxs)("button",{type:"button",style:{width:"min(640px, 100%)",borderRadius:18,border:"1px solid var(--panel-border)",background:"var(--panel)",padding:22,textAlign:"center",marginBottom:16},onClick:()=>void r.reconnect(),children:[(0,t.jsx)("div",{style:{fontSize:18,fontWeight:900,marginBottom:10},children:"å†æŽ¥ç¶š"}),(0,t.jsx)("div",{style:{opacity:.75,fontSize:13,marginBottom:18},children:"ä»¥å‰ã«é–‹ã„ãŸãƒ•ã‚©ãƒ«ãƒ€ã‚’å†èª­ã¿è¾¼ã¿ã—ã¾ã™"})]}):null,(0,t.jsxs)("button",{type:"button",onClick:()=>void r.pickFolder(),style:{width:"min(640px, 100%)",borderRadius:18,border:"1px solid var(--panel-border)",background:"var(--panel)",padding:22,textAlign:"center",marginBottom:16},children:[(0,t.jsx)("div",{style:{fontSize:18,fontWeight:900,marginBottom:10},children:"ãƒ•ã‚©ãƒ«ãƒ€ã‚’ã‚’é¸ã‚“ã§é–‹ã"}),(0,t.jsx)("div",{style:{opacity:.75,fontSize:13,marginBottom:18},children:"ã“ã®ã‚¢ãƒ—ãƒªã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚©ãƒ«ãƒ€ã‚’èª­ã¿è¾¼ã‚“ã§æ›²ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚"})]}),(0,t.jsxs)("div",{role:"note",style:{width:"min(640px, 100%)",borderRadius:16,border:"1px solid var(--warn-border)",background:"var(--warn-bg)",padding:"14px 16px",position:"relative",overflow:"hidden"},children:[(0,t.jsx)("div",{"aria-hidden":!0,style:{position:"absolute",left:0,top:0,bottom:0,width:6,background:"var(--warn-bar)",opacity:1}}),(0,t.jsxs)("div",{style:{minWidth:0},children:[(0,t.jsx)("div",{style:{fontSize:16,fontWeight:900,lineHeight:1.2,color:"var(--warn-title)"},children:"âš ï¸ èª­ã¿è¾¼ã¿ã«å°‘ã—æ™‚é–“ãŒã‹ã‹ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™"}),(0,t.jsx)("div",{style:{marginTop:6,fontSize:15,color:"var(--warn-text)",lineHeight:1.5},children:"æ›²æ•°ã‚„ã‚¸ãƒ£ã‚±ãƒƒãƒˆç”»åƒã®æ•°ãŒå¤šã„ã»ã©æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚å›ºã¾ã£ã¦è¦‹ãˆã¦ã‚‚æ•°ç§’ãŠå¾…ã¡ãã ã•ã„ã€‚"})]})]})]})}var D=e.i(40439);function O(e){let{isPaused:r=!1,children:l}=e;return(0,t.jsxs)("span",{className:`${D.default.npRing}${r?` ${D.default.isPaused}`:""}`,"aria-hidden":"true",children:[l,Array.from({length:12}).map((e,r)=>(0,t.jsx)("span",{},r))]})}var $=e.i(99369);function U(e){let{displayNo:r,trackView:l,index:a,nowPlayingID:i,isPlaying:n,commands:s,setNowItemAction:o}=e,d=r??a+1,u=i===l.item.id;return(0,t.jsx)("li",{className:$.default.item,"data-now-playing":u?"1":"0",children:(0,t.jsxs)("button",{ref:u?e=>o?.(e):void 0,type:"button",className:$.default.rowButton,onClick:()=>s.playAtIndex(a),children:[(0,t.jsx)("span",{className:$.default.colAction,"aria-hidden":!0,children:u?n?(0,t.jsx)(O,{}):(0,t.jsx)(L,{size:20,strokeWidth:2.5,"aria-hidden":!0}):(0,t.jsx)(I,{size:20,strokeWidth:2.5,"aria-hidden":!0})}),(0,t.jsx)("span",{className:$.default.colNo,children:d}),(0,t.jsx)("span",{className:$.default.colArt,"aria-hidden":!0,children:(0,t.jsx)("span",{className:$.default.artBox,"aria-hidden":!0,children:(0,t.jsx)("span",{className:$.default.artInner,children:(0,t.jsx)(A,{url:l.artworkUrl,fallbackText:l.displayTitle??"",seed:l.displayTitle??""})})})}),(0,t.jsx)("span",{className:$.default.colTitle,title:l.displayTitle??"",children:l.displayTitle??"ï¼ˆç„¡é¡Œï¼‰"}),(0,t.jsx)("span",{className:$.default.colYm,children:l.albumTitle}),(0,t.jsx)("span",{className:$.default.colOrig,children:l.originalArtist}),(0,t.jsx)("span",{className:$.default.colPath,title:l.item.path??"",children:l.item.path??"ãªã—"})]})},l.item.id??a)}function q(e){let{trackViews:l,nowPlayingID:a,isPlaying:n,state:s,commands:o,albums:d}=e,u=(0,r.useRef)(null),{settings:c}=(0,i.useSettings)(),m=!!(c.ui.showAlbums&&d&&d.length>0),f=m?"list":c.ui.trackListViewMode??"list",p=c.ui.showFilePath;return((0,r.useEffect)(()=>{if(null==a)return;let e=u.current;e&&e.scrollIntoView({behavior:window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches?"auto":"smooth",block:"nearest",inline:"nearest"})},[a]),!s.folderName||s.needsReconnect)?(0,t.jsx)(M,{state:s,commands:o}):m||0!==l.length?(0,t.jsxs)("section",{className:$.default.trackList,"data-view":f,"data-grid-size":c.ui.trackGridSize??"md","data-show-path":p?"1":"0","data-scroll":"song-list",children:[(0,t.jsxs)("div",{className:$.default.headerRow,"aria-hidden":!0,children:[(0,t.jsx)("div",{className:$.default.colAction}),(0,t.jsx)("div",{className:$.default.colNo,children:"#"}),(0,t.jsx)("div",{className:$.default.colArt,children:"ðŸŽ¨"}),(0,t.jsx)("div",{className:$.default.colTitle,children:"æ›²å"}),(0,t.jsx)("div",{className:$.default.colYm,children:"ã‚¢ãƒ«ãƒãƒ /å¹´æœˆ"}),(0,t.jsx)("div",{className:$.default.colOrig,children:"ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ/åŽŸæ›²"}),(0,t.jsx)("div",{className:$.default.colPath,children:"ãƒ•ã‚¡ã‚¤ãƒ«"})]}),(0,t.jsx)("ul",{className:$.default.list,role:"list",children:m?d.map(e=>(0,t.jsxs)("li",{className:$.default.albumSection,children:[(0,t.jsxs)("div",{className:$.default.albumHeader,children:[(0,t.jsx)(A,{url:e.artworkUrl,size:56,radius:12,fallbackText:e.title,seed:e.title}),(0,t.jsxs)("div",{className:$.default.albumHeaderText,children:[(0,t.jsx)("div",{className:$.default.albumTitle,title:e.title,children:e.title}),(0,t.jsxs)("div",{className:$.default.albumMeta,children:[e.trackCount," æ›²"]})]})]}),(0,t.jsx)("ul",{className:$.default.albumTracks,role:"list",children:e.tracks.map(({t:r,index:l},i)=>(0,t.jsx)(U,{trackView:r,displayNo:i+1,index:l,nowPlayingID:a,isPlaying:n,commands:o,setNowItemAction:e=>{u.current=e}},`${e.key}:${r.item.path}`))})]},e.key)):l.map((e,r)=>(0,t.jsx)(U,{trackView:e,index:r,nowPlayingID:a,isPlaying:n,commands:o,setNowItemAction:e=>{u.current=e}},e.item.path))})]}):(0,t.jsx)(t.Fragment,{children:"èª­ã¿è¾¼ã¿ä¸­"})}e.i(97967);let Y="mp3-song-info-player",V="handles",G="musicDir",K=1,J=new Set(["jpg","jpeg","png","gif","webp"]),Z=new Set(["mp3","wav","ogg"]),Q=new Set(["mp4","m4v","webm","mov"]),X=new Set(["txt"]),ee=new Set(["json"]),et=[/^artwork(?:[.\s_-].+)?$/i,/^cover(?:[.\s_-].+)?$/i,/^album(?:[.\s_-].+)?$/i,/^folder(?:[.\s_-].+)?$/i,/^folder$/i,/^albumart/i,/^albumartsmall$/i,/^albumartlarge$/i,/.+/i],er=e=>{let t=e.lastIndexOf(".");return(t>0?e.slice(0,t):e).trim().toLowerCase()},el=e=>{let t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\")),r=t>=0?e.slice(t+1):e,l=r.lastIndexOf(".");return l<0?r:r.slice(0,l)},ea=e=>{let t=e.lastIndexOf(".");return t<0?"":e.slice(t+1).toLowerCase()},ei=()=>new Promise((e,t)=>{let r=indexedDB.open(Y,K);r.onupgradeneeded=()=>{let e=r.result;e.objectStoreNames.contains(V)||e.createObjectStore(V)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),en=async e=>{let t=await ei();await new Promise((r,l)=>{let a=t.transaction(V,"readwrite");a.objectStore(V).put(e,G),a.oncomplete=()=>r(),a.onerror=()=>l(a.error)})},es=async()=>{let e=await ei();return await new Promise((t,r)=>{let l=e.transaction(V,"readonly").objectStore(V).get(G);l.onsuccess=()=>t(l.result??null),l.onerror=()=>r(l.error)})},eo=async()=>{let e=await ei();await new Promise((t,r)=>{let l=e.transaction(V,"readwrite");l.objectStore(V).delete(G),l.oncomplete=()=>t(),l.onerror=()=>r(l.error)})},ed=async e=>!e.queryPermission||"granted"===await e.queryPermission({mode:"read"}),eu=async e=>!!e.requestPermission&&"granted"===await e.requestPermission({mode:"read"}),ec=`
c057fdbb	2022å¹´	40	é’ã„ãƒ™ãƒ³ãƒ	ã‚µã‚¹ã‚±
bca6ec0a	2022å¹´	50	ã²ã¾ã‚ã‚Šã®ç´„æŸ	ç§¦åŸºåš
5396e324	2022å¹´	60	ãƒ•ãƒ¬ãƒ³ã‚º	ãƒ¬ãƒ™ãƒƒã‚«
810c8c51	2022å¹´	70	ãƒã‚¤ãƒ’ãƒ¼ãƒ«ã‚’è„±ãŽæ¨ã¦ã¦	ZARD
8525a684	2022å¹´	80	é™½ã®ã‚ãŸã‚‹å‚é“	Do As Infinity
72b0a6a2	2022å¹´	90	ã†ã—ã‚ã‚†ã³ã•ã•ã‚Œçµ„	ã†ã—ã‚ã‚†ã³ã•ã•ã‚Œçµ„
dd9e1f20	2022å¹´	100	Happy Halloween	Junky 
2effa7dc	2022å¹´	110	AIAIAI	ã‚­ã‚ºãƒŠã‚¢ã‚¤
e8db1f7b	2022å¹´	120	ã‚¯ãƒªã‚¹ãƒžã‚¹	JUDY AND MARY
e2ae9c56	2023å¹´	10	å‹é”ã§ã„ã„ã‹ã‚‰	é«˜æ©‹ç”±ç¾Žå­
7facf82e	2023å¹´	20	æ„›ã¯å‹ã¤	KAN
e0c61c74	2023å¹´	30	å¯æ„›ãã¦ã”ã‚ã‚“	HoneyWorks
b21186da	2023å¹´	40	ç§ãŒæ‹ã‚’çŸ¥ã‚‹æ—¥	HoneyWorks
14601002	2023å¹´	50	é’æ˜¥ã‚³ãƒ³ãƒ—ãƒ¬ãƒƒã‚¯ã‚¹	çµæŸãƒãƒ³ãƒ‰
f613c0d5	2023å¹´	60	ã‚ãªãŸã«ä¼šãˆã¦ã‚ˆã‹ã£ãŸ	å°æ³‰ä»Šæ—¥å­
630afe3c	2023å¹´	70	æ‹æ„›ã‚µãƒ¼ã‚­ãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³	èŠ±æ¾¤é¦™èœ
5844d699	2023å¹´	80	å›ãŸã¡ã‚­ã‚¦ã‚¤ãƒ»ãƒ‘ãƒ‘ã‚¤ãƒ¤ãƒ»ãƒžãƒ³ã‚´ãƒ¼ã ã­ã€‚	ä¸­åŽŸã‚ã„ã“
9eb89943	2023å¹´	90	secret base ï½žå›ãŒãã‚ŒãŸã‚‚ã®ï½ž	ZONE
d5880f56	2023å¹´	100	staple stable	æˆ¦å ´ãƒ¶åŽŸã²ãŸãŽ
95c09aa5	2023å¹´	110	ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼	ãã‚ƒã‚Šãƒ¼ã±ã¿ã‚…ã±ã¿ã‚…
c1597444	2023å¹´	120	ä¸–ç•ŒãŒçµ‚ã‚ã‚‹ã¾ã§ã¯	WANDS
0d8d715f	2024å¹´	10	ä¸–ç•Œä¸­ã®èª°ã‚ˆã‚Šãã£ã¨	ä¸­å±±ç¾Žç´€
1f4df8d7	2024å¹´	20	æ‹æ„›ã‚µãƒ¼ã‚­ãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³	èŠ±æ¾¤é¦™èœ
558d400f	2024å¹´	30	Answer	SILENT SIREN
76e95e1f	2024å¹´	40	ç§ãŒã‚ªãƒã•ã‚“ã«ãªã£ã¦ã‚‚	æ£®é«˜åƒé‡Œ
e05128ee	2024å¹´	50	ã‚·ãƒ£ãƒ«ãƒ«	é ˆç”°æ™¯å‡ª
3a4723cd	2024å¹´	60	æœ€æ‚ªãªæ—¥ã§ã‚‚ã‚ãªãŸãŒå¥½ãã€‚	èŠ¹æ¾¤å„ª
640c3f70	2024å¹´	70	ã‚‚ã†å°‘ã— ã‚ã¨å°‘ã—	ZARD
82316990	2024å¹´	80	ãƒ–ãƒ«ãƒ¼ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼	æ£®å·ç¾Žç©‚
65012111	2024å¹´	90	ãªãœ...	Hysteric Blue
183147bd	2024å¹´	100	ã¾ã¡ã¶ã›	çŸ³å·ã²ã¨ã¿
7ae10e48	2024å¹´	110	é›¨ã«æ¿¡ã‚Œã¦	ZARD
ceb78e9e	2024å¹´	120	P.S.I LOVE YOU	PINK SAAPPHIRE
745f2ff4	2025å¹´	10	SWEET MEMORIES	æ¾ç”°è–å­
b37e0306	2025å¹´	20	Squall	æ¾æœ¬è‹±å­
ebf5f23f	2025å¹´	30	ãƒãƒ§ã‚³ãƒ¬ã‚¤ãƒˆãƒ»ãƒ‡ã‚£ã‚¹ã‚³	Perfume
662ff084	2025å¹´	40	ã™ã¿ã‚Œ September Love	SHAZNA
b12764f9	2025å¹´	50	ãƒ©ã‚¤ã‚ªãƒ³	ä¸­å³¶æ„›
974db37b	2025å¹´	60	é›¨	æ£®é«˜åƒé‡Œ
306d7eae	2025å¹´	70	ã‚¹ã‚­ãƒžã‚¸ã‚«ãƒ³	ã‚¢ãƒãƒ¢ãƒ
920db4de	2025å¹´	80	ãƒãƒ¬æ™´ãƒ¬ãƒ¦ã‚«ã‚¤	ï¼³ï¼¯ï¼³å›£
96ea2b87	2025å¹´	90	ãƒãƒ å¤ªéƒŽã¨ã£ã¨ã“ã†ãŸ	ãƒãƒ ã¡ã‚ƒã‚“ãš
df9c14b9	2025å¹´	91	é›¨ã«ã‚­ãƒƒã‚¹ã®èŠ±æŸã‚’	ä»Šäº•ç¾Žæ¨¹
059c5a7f	2025å¹´	100	çŽ‹å­æ§˜ã¨é›ªã®å¤œ	ã‚¿ãƒ³ãƒãƒ
7908c3c9	2025å¹´	101	slash	Yama
ab60eda7	2025å¹´	110	èµ¤ã„æ—¥è¨˜å¸³	ã‚ã‹çµ„4
e80c942e	2025å¹´	111	ä¹™å¥³ ãƒ‘ã‚¹ã‚¿ã«æ„Ÿå‹•	ã‚¿ãƒ³ãƒãƒ
cd4a611d	2025å¹´	120	å¤§äººã«ãªã‚“ã‹ãªã‚‰ãªã„ã‚ˆ	å¤©åœ° ç·å­
5975ee4c	2025å¹´	121	å¤§äººã«ãªã‚“ã‹ãªã‚‰ãªã„ã‚ˆ	å¤©åœ° ç·å­
88f99591	2026å¹´	10	ç·‹è‰²ã®ç©º	å·ç”°ã¾ã¿
52b4a08d	2026å¹´	20	ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³ãƒ»ã‚­ãƒƒã‚¹	å°å€‰ å”¯
`,em=(e,t)=>{var r;let l=e.trim();if(!l||l.startsWith("#"))return null;let a=l.split(t),i=(a[0]??"").trim(),n=(a[1]??"").trim(),s=(r=a[2])?Number((r??"").trim()):0,o=(a[3]??"").trim(),d=(a[4]??"").trim();return n&&o?{prefixId:i||null,albumTitle:n,track:s,title:o,originalArtist:d||null}:null},ef={"Yume no Tojou":`ã¾ã æ­£å¤¢ã®é€”ä¸Šï¼ˆã¨ã˜ã‚‡ã†ï¼‰ã ã‚ˆ
ã¨ã˜ã‚‡ã¿ã‚“ï¼ˆã‚­ãƒŸï¼‰ã¨æ­©ã‚‚ã† ã“ã®æ¾æˆ¸ï¼ˆã¾ã¡ï¼‰ã§

èª°ã‹ã‚’ç¾¨ã‚€ã ã‘ã˜ã‚ƒ
æœªæ¥ã‚‚ãã£ã½ã‚’å‘ã„ã¡ã‚ƒã†ã‚ˆï¼Ÿ
é€†å¢ƒã‚‚ Link up è‘›è—¤ã‚‚ Twinkle
å¤¢ã«ã¯ ä¸å¯æ¬ ãªãƒ¬ã‚·ãƒ”

ã“ã“ã‚ãŒé›¨é™ã‚Šãªæ—¥ã‚‚
å¤©ç„¶è‰²ã®ç©ºã‚’è¦‹ã‚ˆã†
ã‚¢ãƒ‹ãƒžãƒ«ã® Link up ç¶¿é›² Twinkle
æŽ¢ã›ã° ã¾ãŸå…ƒæ°—å‡ºã‚‹ã‚ˆ

ãƒ¢ãƒ³ãƒ€ã‚¤ã¨ã‹ ã²ã¨ã¤ã‚‚èµ·ããªã„
ã‚¹ãƒˆãƒªãƒ¼ã¯ãƒŠã‚¤ãƒŠã‚¤ãƒŠã‚¤
è´ã“ãˆã¦ã‚‹ ã¿ã‚“ãªã®ãã®å£°æ´ï¼ˆã“ãˆï¼‰
ã ã‹ã‚‰ ãœã‚“ã¶è¶Šãˆã¦ã‚†ã‘ã‚‹
å½“ãŸã‚Šå‰ã¨ã‹ ã²ã¨ã¤ã‚‚ãªã„ï¼

ã¾ã æ­£å¤¢ã®é€”ä¸Šï¼ˆã¨ã˜ã‚‡ã†ï¼‰ã ã‚ˆ
ã‚„ã£ã¨ ã¤ã¼ã¿ ã¤ã‘ãŸã®
ã»ã‚‰ èŠ±ã«æ°´ ã¨ã˜ã‚‡ã¿ã‚“ï¼ˆã‚­ãƒŸï¼‰ã«ã‚­ã‚¹
å¤¢ã‚’å’²ã‹ãã† ã“ã®æ¾æˆ¸ï¼ˆã¾ã¡ï¼‰ã§

ã¡ã£ã°ã£ã° åƒã£è‘‰ã£è‘‰ ã¡ã£ã°ã£ã°

ã€Œä½•ãŒèµ·ãã‚‹ï¼Ÿã€ï¼’ï¼‘ä¸–ç´€
â€ãªã—â€ããšã—ã˜ã‚ƒ ãã£ã¨ãƒ€ãƒ¡
ä½•ãŒèµ·ãã¦ã‚‚ ä¿¡ã˜ã‚‰ã‚Œã‚‹
ã‚­ã‚ºãƒŠãŒã‚ã‚Œã° å¤§ä¸ˆå¤«ï¼

ãƒ¢ãƒ³ãƒ€ã‚¤ãªã„ã‚ˆï¼Ÿ ã‚¢ãƒªã‚¬ãƒˆã²ã¨ã¤ã§
ãƒŠãƒŸãƒ€ã¯ ã„ãªã„ã„ãªã„ã°ã‚ã£ï¼
å‹¿ä½“ãªã„ã‚ˆï¼Ÿ ã¡ã‚ƒã‚“ã¨ä¼ãˆãªãã‚ƒ
ã„ã¤ã‚‚ãã°ã§ å…ƒæ°—ãã‚Œã‚‹
ãã®ã‚„ã•ã—ã•ã« å¤§æ„Ÿè¬ã£

ã¾ã é•·æ—…ã®é€”ä¸Šï¼ˆã¨ã˜ã‚‡ã†ï¼‰ã ã‚ˆ
ç©ºã« è™¹ã‚’æ‡¸ã‘ã¦ã„ã
è¿·ã„ãªãŒã‚‰ã§ã‚‚ é€²ã‚“ã§ã„ã“ã†
ã¨ã˜ã‚‡ã¿ã‚“ï¼ˆã‚­ãƒŸï¼‰ãŒã„ã‚Œã° ã‚ãã‚‰ã‚ãªã„

ä½•åº¦ã‚‚ æ³£ã„ã¦ã‚‚ ã„ãªã„ã„ãªã„ã°ã‚ã£ï¼
ã‚ã—ãŸã¯ã§ãã‚‹ å¤§ä¸ˆå¤«ï¼

ã¾ã æ­£å¤¢ã®é€”ä¸Šï¼ˆã¨ã˜ã‚‡ã†ï¼‰ã ã‚ˆ
ã‚„ã£ã¨ ã¤ã¼ã¿ ã¤ã‘ãŸã®
ã»ã‚‰ èŠ±ã«æ°´ ã¨ã˜ã‚‡ã¿ã‚“ï¼ˆã‚­ãƒŸï¼‰ã«ã‚­ã‚¹
å¤¢ã‚’å’²ã‹ãã† ã“ã®æ¾æˆ¸ï¼ˆã¾ã¡ï¼‰ã‹ã‚‰

ã¾ã é•·æ—…ã®é€”ä¸Šï¼ˆã¨ã˜ã‚‡ã†ï¼‰ã ã‚ˆ
ç©ºã« è™¹ã‚’æ‡¸ã‘ã¦ã„ã
è¿·ã„ãªãŒã‚‰ã§ã‚‚ é€²ã‚“ã§ã„ã“ã†
ã¨ã˜ã‚‡ã¿ã‚“ï¼ˆã‚­ãƒŸï¼‰ãŒã„ã‚Œã° ã‚ãã‚‰ã‚ãªã„

ã­ãˆ ã‚¢ãƒªã‚¬ãƒˆã˜ã‚ƒè¶³ã‚Šãªã„ã‚ˆ
ã“ã“ã‚è¾¼ã‚ã¦ã€Œã‚ã„ã—ã¦ã„ã‚‹ã‚ã€`,ãƒãƒã‚±ãƒ³ã‚µãƒ³ãƒ:`-ã€€

CHI-CHI-BA-BA-BA CHI-CHI-CHI-BA-BA-BA
CHI-CHI-BA-BA-BA CHI-CHI-CHI-BA-BA-BA
CHI-CHI-BA-BA-BA ã¯ã£ã´ãƒ¼ãªä¸–ç•Œ
ã‚„ã‚“ã¹ãƒ¼!ã¹ãƒ¼!ãƒ™ãƒ¼!ã‚„ã‚“ã¹ãƒ¼!ã¹ãƒ¼!ãƒ™ãƒ¼!ãƒ™ãƒ¼!(ãƒ•ãƒ¼!)

è½èŠ±ç”Ÿé£Ÿã¹ãªãŒã‚‰ ãƒ“ãƒ¯ã®é›»è»Šã«æºã‚‰ã‚Œ
ã²ã‚ãŒã‚‹çª“ã®æ™¯è‰²ã‹ãŒã‚„ã‘!åƒè‘‰ã®è¡—

é‹¸å±±ã®ã„ãŸã ãã¯ ã‚®ã‚¶ã‚®ã‚¶
ãã“ã§ ãã£ã¨ã¿ã¤ã‹ã‚‹ å¤¢ã®å ´æ‰€(ãƒãƒãƒƒ)

ã»ã“ã‚Šé«˜ããƒ›ã‚ªã‚¸ãƒ­ã®æ­Œã§é£›ã³å‡ºãã†

ã„ã¤ã§ã‚‚ã­ ã¡ã‹ãã«ã­
èžã“ãˆã‚‹ã‚ˆã‚µãƒ³ãƒ
ãƒãƒã‚±ãƒ³ã‚µãƒ³ãƒ(ãŠã‚Œ!)

é­…æƒ‘ã²ã‚ãŒã‚‹ç”˜ã„ã‚³ãƒ¼ãƒ’ãƒ¼ã« ã‚µãƒ³ãƒã®ãƒªã‚ºãƒ ã§
å®ç®±ã‚’é–‹ã‘ãŸã‚‰ æµ·ã®ãƒ›ã‚¿ãƒ«ã¨ãã˜ã‚‰ãŸã¡ ãƒ™ãƒ¼!
ãƒãƒã‚±ãƒ³ã‚µãƒ³ãƒ~(ã‚ªãƒ¬!)
(é–“å¥)

CHI-CHI-BA-BA-BA CHI-CHI-CHI-BA-BA-BA
CHI-CHI-BA-BA-BA CHI-CHI-CHI-BA-BA-BA
CHI-CHI-BA-BA-BA ã‚·ãƒ£ãƒã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥!
ã‚„ã‚“ã¹ãƒ¼!ã¹ãƒ¼!ãƒ™ãƒ¼!ã‚„ã‚“ã¹ãƒ¼!ã¹ãƒ¼!ãƒ™ãƒ¼!ãƒ™ãƒ¼!(ãƒ•ãƒ¼!)

éŠšå­ç¯å°ã®é¢¨ å¸½å­ãŠã•ãˆãªãŒã‚‰
ç™»ã‚‹æœæ—¥ã‚’æ„Ÿã˜ã‚‹ é­šãŸã¡ãŒã†ãŸã†

ä¹åä¹é‡Œæµœã‚’é§†ã‘æŠœã‘
å¤¢ã¨ãƒªã‚ºãƒ ã¿ãˆã‚‹

ä¸€ç·’ã«è¸Šã‚ã†ç´„æŸã­(ã­!)
ã‚„ã•ã—ãå’²ã èœã®èŠ±ã®é¦™ã‚Šã“ã“ã‚å¼¾ã‚€

ã„ã¤ã§ã‚‚ã­ ã¡ã‹ãã«ã­
èžã“ãˆã‚‹ã‚ˆã‚µãƒ³ãƒ
ãƒãƒã‚±ãƒ³ã‚µãƒ³ãƒ(ãŠã‚Œ!)
é­…æƒ‘ã²ã‚ãŒã‚‹ç”˜ã„åƒè‘‰ã®æ¢¨ ã‚µãƒ³ãƒã®ãƒªã‚ºãƒ ã§
æµ·é®®ã¯ã“ã“ã«ã‚ã‚‹!ãƒ©ãƒ¼ãƒ¡ãƒ³ã‚‚å¾…ã£ã¦ã„ã‚‹ ã¹ãƒ¼
ãƒãƒã‚±ãƒ³ã‚µãƒ³ãƒ~(ã‚ªãƒ¬!)

-`,åƒ•ãŸã¡ã®è‹±èªžç‰©èªž:`åƒ•é”ã® å¤¢èªžã‚Šï¼ˆã‚†ã‚ãŒãŸã‚Šï¼‰

ä¸–ç•Œä¸­ã‚’å·¡ã£ã¦ æ–°ã—ã„å‡ºä¼šã„ãŒå¾…ã£ã¦ã‚‹
ã†ã¾ãã„ã‹ãªã„ã“ã¨ã ã£ã¦ ã‚ã‚‹ã‘ã©æ°—ã«ã—ã¦ã‚‰ã‚Œãªã„

ãƒãƒ§ã‚³ã‚’ è²¯ã‚ã¦ åŠ›ã‚’åˆã‚ã›ã¦ ã¤ãªã’ãŸæœªæ¥ã¸å‘ã‹ã£ã¦
ã‚­ãƒŸã¨ ä¸€ç·’ã« ã“ã‚“ãªã¨ã“ã‚ã§ã¯ è² ã‘ã‚‹ã‚ã‘ã«ã¯ã„ã‹ãªã„ã‚“ã ã‹ã‚‰

è‹±èªžç‰©èªž
ã¿ã‚“ãªã§ã¤ãã‚‹ç‰©èªž
è‹±èªžç‰©èªž
åƒ•é”ã® å¤¢èªžã‚Šï¼ˆã‚†ã‚ãŒãŸã‚Šï¼‰

è‹±èªžç‰©èªž è‹±èªžç‰©èªž
åƒ•é”ã¯ ã‚„ã‚Œã‚‹ã‚“ã ã‹ã‚‰

è‹±èªžç‰©èªž
ã¿ã‚“ãªã§ã¤ãã‚‹ç‰©èªž
è‹±èªžç‰©èªž
åƒ•é”ã® å¤¢èªžã‚Šï¼ˆã‚†ã‚ã‹ãŸã‚Šï¼‰`,åƒ•ã‚‰ã¯æˆ¸å®šå»ºè¨­å“¡:`é™½ãŒæ˜‡ã‚Š å§‹ã¾ã‚‹ãž ç´ æ™´ã‚‰ã—ã„æ—¥ã 
è¼ãæ±—ã¯å…¨éƒ¨ å¤¢ã¸ã¨ã¤ãªãŒã‚‹

ã¯ã„ï¼Yesï¼ã¯ã„ï¼Yesï¼
ã€ŒåŠ›ã‚’åˆã‚ã›ã¦ï¼ã€
ã¯ã„ï¼Yesï¼ã¯ã„ï¼Yesï¼
ç›£ç£ã®å£°ãŒ èƒ¸ã«éŸ¿ãã‚“ã 

ã€Œå®‰å…¨ã¯ï¼Ÿã€ç¬¬ä¸€ã« ã€Œä¼‘æ†©ã¯ï¼Ÿã€ä¸€åˆ†ã 
ã€Œçµ¦æ–™ã¯ï¼Ÿã€ã„ã‚‰ãªã„ã‚ˆ ç¬‘é¡”ã§ã„ããž
åƒ•ã‚‰ã¯ æˆ¸å®šå»ºè¨­å“¡

ãŠæ˜¼ã ãž ã”é£¯ã ãž ç´ æ™´ã‚‰ã—ã„æ—¥ã 
é£¯ãƒ†ãƒ­é…ä¿¡ã§ ãŠãªã‹ã¯ãƒšã‚³ãƒšã‚³

ã¯ã„ï¼Yesï¼ã¯ã„ï¼Yesï¼
ã€ŒãŸãã•ã‚“é£Ÿã¹ã‚ˆã†ï¼ã€
ã¯ã„ï¼Yesï¼ã¯ã„ï¼Yesï¼
ç›£ç£ã®å£°ãŒ èƒ¸ã«éŸ¿ãã‚“ã 

ã€Œåƒè‘‰çœŒã¯ï¼Ÿã€ç´ æ•µã ã‚ˆ ã€Œæ¾æˆ¸å¸‚ã¯ï¼Ÿã€ç´ æ•µã ã­
ã€Œç›£ç£ã¯ï¼Ÿã€ã‹ã‚ã„ã„ã‚ˆ ç¬‘é¡”ã§ã„ããž
åƒ•ã‚‰ã¯ æˆ¸å®šå»ºè¨­å“¡

ã€Œã¿ã‚“ãªãŒã„ã‚Œã°ä½•ã§ã‚‚ã§ãã‚‹ ãã†æ€ã‚ã›ã¦ãã‚Œã‚‹ã‚“ã ã€
ã€Œã‚‚ã—ã‚‚æ‚²ã—ã¿ã§è¿·å­ã«ãªã£ãŸã‚‰ æ‰‹ã‚’ã¤ãªã„ã§æ­©ã„ã¦è¡Œã“ã†ï¼Ÿã€ï¼ˆã‚ªãƒ¼ï¼ï¼‰
ã€Œã¿ã‚“ãªã®ã“ã¨ãŒå¤§å¥½ãã ï¼ã€ï¼ˆã‚ªãƒ¼ï¼ï¼‰

ã€Œå®‰å…¨ã¯ï¼Ÿã€ç¬¬ä¸€ã« ã€Œä¼‘æ†©ã¯ï¼Ÿã€ä¸€åˆ†ã 
ã€Œçµ¦æ–™ã¯ï¼Ÿã€ã„ã‚‰ãªã„ã‚ˆ ç¬‘é¡”ã§ã„ããž

ã€Œåƒè‘‰çœŒã¯ï¼Ÿã€ç´ æ•µã ã‚ˆ ã€Œæ¾æˆ¸å¸‚ã¯ï¼Ÿã€ç´ æ•µã ã­
ã€Œç›£ç£ã¯ï¼Ÿã€ã‹ã‚ã„ã„ã‚ˆ ç¬‘é¡”ã§ã„ããž

åƒ•ã‚‰ã¯æˆ¸å®šå»ºè¨­å“¡ ç„¡æ•µã® æˆ¸å®šå»ºè¨­å“¡
åƒããžï¼ï¼ˆã‚ªãƒ¼ï¼ï¼‰ æ®‹æ¥­ã ï¼ï¼ˆã‚ªãƒ¼ï¼ï¼‰`},ep=[{keyword:"Yume no Tojou",key:"Yume no Tojou"},{keyword:"åƒ•ã‚‰ã¯æˆ¸å®šå»ºè¨­å“¡",key:"åƒ•ã‚‰ã¯æˆ¸å®šå»ºè¨­å“¡"},{keyword:"ãƒãƒã‚±ãƒ³ã‚µãƒ³ãƒ",key:"ãƒãƒã‚±ãƒ³ã‚µãƒ³ãƒ"},{keyword:"chibakensamba",key:"ãƒãƒã‚±ãƒ³ã‚µãƒ³ãƒ",title:"ãƒãƒã‚±ãƒ³ã‚µãƒ³ãƒ"},{keyword:"åƒ•ãŸã¡ã®è‹±èªžç‰©èªž",key:"åƒ•ãŸã¡ã®è‹±èªžç‰©èªž"}],eh=e=>e.normalize("NFKC").toLowerCase().trim(),ey=async e=>{let t=eh(e),r=ep.find(e=>t.includes(eh(e.keyword)));if(!r)return null;let l=ef[r.key];return l||null},eg=()=>"undefined"!=typeof navigator&&"mediaSession"in navigator,ew=(e,t,r)=>Math.min(r,Math.max(t,e)),eb=(e,t)=>Number.isFinite(e)?e:t,ex=()=>"undefined"!=typeof navigator&&"mediaSession"in navigator,ev=()=>ex()&&"function"==typeof navigator.mediaSession.setPositionState,ek=e=>{if("string"!=typeof e)return;let t=e.trim();return""===t?void 0:t},e_=e=>{if("number"==typeof e)return Number.isFinite(e)?e:void 0},ej=async e=>{try{let t,r,l,a,i,n=await e.getFile(),s=await n.text(),o=(s.startsWith("\uFEFF")?s.slice(1):s).trim();if(""===o)return null;let d=JSON.parse(o);if("object"!=typeof d||null===d||Array.isArray(d))return null;return t=d.schemaVersion,r=ek(d.albumTitle)??ek(d.album),l=e_(d.discNo)??e_(d.diskNo),a=e_(d.trackNo),i={schemaVersion:1,title:ek(d.title),artist:ek(d.artist),albumTitle:r,albumArtist:ek(d.albumArtist),trackNo:a,discNo:l,artworkFileName:ek(d.artworkFileName)??ek(d.coverFileName)??ek(d.jacketFileName)??ek(d.pictureFileName)??ek(d.picture)},1===((1===t?1:void 0)??1)?i:null}catch{return null}},eA=async()=>{await new Promise(e=>setTimeout(e,0))},eN=async e=>{let{scanResult:t,items:r,runIdRef:l,runId:a,track:i,setArtworkUrlByPath:n}=e,s=Array.from(new Set(r.map(e=>C(e.path))));for(let e of(n(()=>{let e={};for(let t of s)e[t]=null;return e}),s)){if(l.current!==a)return;let r=t.dirBestImageByDir.get(e);if(!r){await eA();continue}try{let t=await r.getFile(),l=URL.createObjectURL(t);i(l),n(t=>t[e]===l?t:{...t,[e]:l})}catch{}await eA()}},eC=e=>e.replace(/^\uFEFF/,"").replace(/\r\n?/g,"\n"),eS=e=>null!=e&&e.trim().length>0,eT=e=>{let t=new Uint8Array(e);try{return new TextDecoder("utf-8",{fatal:!0}).decode(t)}catch{}try{return new TextDecoder("shift_jis",{fatal:!1}).decode(t)}catch{return new TextDecoder("utf-8",{fatal:!1}).decode(t)}},eL=async()=>{await new Promise(e=>setTimeout(e,0))},eI=async e=>{let{items:t,runIdRef:r,runId:l,setMetaByPath:a}=e,i=0,n=async()=>{for(;i<t.length;){if(r.current!==l)return;let e=t[i++],n=e.lyricsTextHandle;if(!n){await eL();continue}try{let t=await n.getFile(),r=await t.arrayBuffer(),l=eT(r),i=eC(l);if(!eS(i)){await eL();continue}a(t=>{let r=t[e.path];return!r||eS(r.lyrics)?t:{...t,[e.path]:{...r,lyrics:i}}})}catch{}await eL()}};await Promise.all(Array.from({length:2},()=>n()))},eP=(e,t)=>{let r=new Uint8Array([...e].map(e=>255&e.charCodeAt(0)));return new TextDecoder(t,{fatal:!1}).decode(r)},eB=e=>{let t,r,l=e.replace(/\u0000/g,"").trim();if(0===l.length||(t=/[\u0080-\u00FF]/.test(l),r=/[\u3040-\u30FF\u3400-\u9FFF]/.test(l),!t||r))return l;try{let e=eP(l,"shift_jis").trim();if(e)return e}catch{}try{let e=eP(l,"utf-8").trim();if(e)return e}catch{}return l},eE=e=>{if(!e)return;if(Array.isArray(e)){for(let t of e){let e=eE(t);if(e)return e}return}if("string"==typeof e)return e;let t=e.text;if("string"==typeof t&&t.trim().length>0)return t},ez=e=>{if(!e)return null;let t=e.replace(/\r\n?/g,"\n").trim();return t.length>0?t:null},eH=(e,t)=>{let r=t.native;if(!r)return null;for(let t of["ID3v2.3","ID3v2.4","ID3v2.2","ID3v1"]){let l=r[t];if(l)for(let t of e){let e=l.find(e=>e.id===t);if(!e)continue;let r=e.value;if("string"==typeof r){let e=eB(r);if(e)return e}if(Array.isArray(r)){let e=r.find(e=>"string"==typeof e&&e.trim());if("string"==typeof e){let t=eB(e);if(t)return t}}}}return null},eR=async t=>{let{parseBlob:r}=await e.A(8765),l=await r(t,{duration:!1}),a=l.common,i=a.picture?.[0],n=Array.isArray(a.lyrics)?a.lyrics[0]:void 0,s=eH(["USLT","ULT"],l)??n??void 0,o=eH(["SYLT","SLT"],l)??void 0;return{title:eH(["TIT2","TT2"],l)??a.title??null,artist:eH(["TPE1","TP1"],l)??a.artist??a.artists?.join(", ")??null,album:eH(["TALB","TAL"],l)??a.album??null,trackNo:a.track?.no??null,year:a.year??null,picture:i?{data:i.data,format:i.format}:null,lyrics:ez(eE(s)),lyricsLrc:ez(eE(o)),albumArtist:null,discNo:null,diskNo:null}},eF=async()=>{await new Promise(e=>setTimeout(e,0))},eW=async e=>{let{items:t,runIdRef:r,track:l,setMetaByPath:a,setArtworkUrlByPath:i,shouldDeferTag:n}=e,s=++r.current,o=async e=>{if(r.current===s){try{let t=await e.fileHandle.getFile(),n=await eR(t),o=((e,t)=>{if(!t)return null;let r=new Blob([new Uint8Array(t.data)],{type:t.format}),l=URL.createObjectURL(r);return e(l),l})(l,n.picture??void 0);if(r.current!==s)return;o&&i(t=>t[e.path]?t:{...t,[e.path]:o}),a(t=>{let r=t[e.path];if(!r)return t;let l={...r,title:r.title?.trim()?r.title:n.title??r.title,artist:r.artist?.trim()?r.artist:n.artist??r.artist,album:r.album?.trim()?r.album:n.album??r.album,year:r.year??n.year,trackNo:r.trackNo??n.trackNo,lyrics:r.lyrics?.trim()?r.lyrics:n.lyrics??r.lyrics,lyricsLrc:r.lyricsLrc?.trim()?r.lyricsLrc:n.lyricsLrc??r.lyricsLrc};return{...t,[e.path]:l}})}catch{}await eF()}},d=[];for(let e of t){if(r.current!==s)return;if(n?.(e)){d.push(e);continue}await o(e)}for(let e of d){if(r.current!==s)return;await o(e)}},eM=async()=>{await new Promise(e=>setTimeout(e,0))},eD=e=>{let t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\")),r=t>=0?e.slice(t+1):e,l=r.lastIndexOf(".");return l<=0?r:r.slice(0,l)},eO=(e,t)=>e?`${e}/${t}`:t,e$=async e=>{let{scanResult:t,items:r,runIdRef:l,runId:a,track:i,setArtworkUrlByPath:n}=e,s=0,o=async()=>{for(;s<r.length;){if(l.current!==a)return;let e=r[s++],o=eO(C(e.path),eD(e.path)),d=t.bundleByKey.get(o),u=d?.trackImage?.handle;if(!u){await eM();continue}try{let t=await u.getFile(),r=URL.createObjectURL(t);i(r),n(t=>{let l=t[e.path];return null!=l?t:{...t,[e.path]:r}})}catch{}await eM()}};await Promise.all(Array.from({length:2},()=>o()))},eU=async()=>{await new Promise(e=>setTimeout(e,0))},eq=async e=>{let{items:t,runIdRef:r,runId:l,setMetaByPath:a}=e,i=0,n=async()=>{for(;i<t.length;){if(r.current!==l)return;let e=t[i++],n=e.infoHandle;if(!n){await eU();continue}try{let t=await ej(n);a(r=>{if(!t)return r;let l=r[e.path];if(!l)return r;let a={...l,title:t.title?.trim()?t.title:l.title??t.title,artist:t.artist?.trim()?t.artist:l.artist??t.artist,album:t.albumTitle?.trim()?t.albumTitle:l.album??t.albumTitle,year:t.albumArtist??l.albumArtist,discNo:t.discNo??l.discNo,trackNo:t.trackNo??l.trackNo,artworkFileName:t.artworkFileName??l.picture};return{...r,[e.path]:a}})}catch{}await eU()}};await Promise.all(Array.from({length:2},()=>n()))},eY=(e,t)=>e?`${e}/${t}`:t,eV=(e,t)=>e?`${e}/${t}`:t,eG=e=>{let t=et.findIndex(t=>t.test(e));return t>=0?t:1/0},eK=async(e,t="")=>{let r=new Map,l=new Set,a=new Map,i=async(e,t)=>{for await(let[n,s]of(l.add(t),e)){let e=eY(t,n);if("directory"===s.kind){await i(s,e);continue}let l=ea(n),o=el(n),d=eV(t,o),u=r.get(d)??{dirPath:t,baseName:o};if(Z.has(l)||Q.has(l)){u.audio={path:e,ext:l,handle:s},r.set(d,u);continue}if(X.has(l)){u.lyricsTxt={path:e,handle:s},r.set(d,u);continue}if(J.has(l)){let i=eG(er(n)),o=a.get(t);(!o||i<o.priority)&&a.set(t,{priority:i,handle:s}),u.trackImage||(u.trackImage={path:e,handle:s,ext:l},r.set(d,u));continue}ee.has(l)&&(u.trackInfo={path:e,handle:s},r.set(d,u))}};await i(e,t);let n=[...r.values()],s=new Map;for(let[e,t]of a.entries())s.set(e,t.handle);return{bundles:n,dirPaths:[...l.values()],bundleByKey:r,dirBestImageByDir:s}},eJ=e=>{let t=e.split("/").filter(Boolean).pop()??"",r=/([0-9a-fA-F]{8})_/.exec(t);return r?r[1].toLowerCase():null},eZ=async e=>{let{handle:t,track:r,infoRunIdRef:l,dirArtworkRunIdRef:a,metaRunIdRef:i,lyricsRunIdRef:n,setFolderName:s,setMp3List:o,setMetaByPath:d,setArtworkUrlByPath:u}=e;s(t.name);let{scanResult:c,items:m}=await eQ(t,"");o(m),d(()=>(e=>{let t={};for(let r of e)t[r.path]={discNo:null,diskNo:null,albumArtist:null,picture:null,title:"",artist:"",album:"",trackNo:null,year:null,lyrics:null,lyricsLrc:null};return t})(m));let f=++l.current;eq({items:m,runIdRef:l,runId:f,setMetaByPath:d});let p=++a.current;e$({scanResult:c,items:m,runIdRef:a,runId:p,track:r,setArtworkUrlByPath:u}),eN({scanResult:c,items:m,runIdRef:a,runId:p,track:r,setArtworkUrlByPath:u}),eW({items:m,runIdRef:i,track:r,setMetaByPath:d,setArtworkUrlByPath:u,shouldDeferTag:e=>!!eJ(e.path)});let h=++n.current;eI({items:m,runIdRef:n,runId:h,setMetaByPath:d})},eQ=async(e,t)=>{let r=await eK(e,t),l=new Intl.Collator("ja",{numeric:!0,sensitivity:"base"}),a=e=>e.replaceAll("\\","/").split("/").filter(Boolean),i=r.bundles.filter(e=>null!=e.audio).sort((e,t)=>((e,t)=>{let r=a(e),i=a(t),n=Math.min(r.length,i.length);for(let e=0;e<n;e+=1){let t=l.compare(r[e],i[e]);if(0!==t)return t}return r.length-i.length})(e.audio.path,t.audio.path)).map((e,t)=>{let r=e.audio,l=e.lyricsTxt?.handle,a=e.trackInfo?.handle;return{id:t+1,path:r.path,name:r.handle.name,lastModified:null,fileHandle:r.handle,lyricsTextHandle:l,infoHandle:a}});return{scanResult:r,items:i}},eX=async e=>{let{resetView:t,buildList:r,setNeedsReconnect:l,setSavedHandle:a,setErrorMessage:i}=e,n=window.isSecureContext?"function"!=typeof window.showDirectoryPicker?"ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ãƒ•ã‚©ãƒ«ãƒ€é¸æŠžã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚Chrome/Edgeã§ãŠè©¦ã—ãã ã•ã„ã€‚":null:"HTTPSã§é–‹ã„ã¦ãã ã•ã„ï¼ˆã‚»ã‚­ãƒ¥ã‚¢ãªæŽ¥ç¶šãŒå¿…è¦ã§ã™ï¼‰ã€‚";if(n)return void i(n);t(),l(!1);try{let e=await window.showDirectoryPicker({mode:"read"});await en(e),a(e),await r(e)}catch(e){i(e instanceof Error?e.message:String(e))}},e0=async e=>{let{savedHandle:t,resetView:r,buildList:l,setNeedsReconnect:a,setErrorMessage:i}=e;if(i(""),t){if(!await eu(t)){a(!0),i("ãƒ•ã‚©ãƒ«ãƒ€ã¸ã®èª­ã¿å–ã‚Šæ¨©é™ãŒä»˜ä¸Žã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚");return}r(),await l(t),a(!1)}},e1=async e=>{let{resetView:t,setSavedHandle:r,setNeedsReconnect:l}=e;await eo(),r(null),l(!1),t()},e2=e=>{let t=[...e];for(let e=t.length-1;e>0;e-=1){let r=Math.floor(Math.random()*(e+1)),l=t[e];t[e]=t[r],t[r]=l}return t},e5=(e,t)=>{if(!Number.isFinite(e.currentTime))return;let r=e.currentTime+t,l=Number.isFinite(e.duration)&&e.duration>0?e.duration:1/0;e.currentTime=r<0?0:r>l?l:r},e3=e=>{if("string"!=typeof e)return null;let t=e.trim();return t.length>0?t:null},e9=e=>{if(null==e)return null;if("string"==typeof e){let t=e.trim();return t.length>0?t:null}return"number"==typeof e&&Number.isFinite(e)?String(e):null},e4=e=>e.replaceAll("\\","/").replace(/^\/+/,"").split("/").map(e=>e.trim()).filter(e=>e.length>0),e6=async e=>"granted"===await e.queryPermission({mode:"readwrite"})||"granted"===await e.requestPermission({mode:"readwrite"}),e8=async(e,t)=>{let r=e;for(let e of t)r=await r.getDirectoryHandle(e,{create:!1});return r},e7=async e=>{let t,r,l,a,{rootDirHandle:i,nowPlayingPath:n,imageFile:s}=e,o=(t=e4(n)).slice(0,Math.max(0,t.length-1)),d=await e8(i,o);if(!await e6(d))throw Error("ãƒ•ã‚©ãƒ«ãƒ€ã¸ã®æ›¸ãè¾¼ã¿æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");let u=(a=(l=(r=e4(n))[r.length-1]??"").lastIndexOf("."))<=0?l:l.slice(0,a);if(!u)throw Error("å†ç”Ÿä¸­ãƒ•ã‚¡ã‚¤ãƒ«åã®è§£æ±ºã«å¤±æ•—ã—ã¾ã—ãŸã€‚");let c=(e=>{let t=e.name??"",r=t.lastIndexOf(".");if(r>=0&&r<t.length-1)return t.slice(r);let l=e.type??"";return"image/png"===l?".png":"image/jpeg"===l?".jpg":"image/webp"===l?".webp":"image/gif"===l?".gif":"text/plain"===l?".txt":""})(s);if(!c)throw Error("ç”»åƒã®æ‹¡å¼µå­ãŒåˆ¤å®šã§ãã¾ã›ã‚“ã€‚");let m=`${u}${c}`,f=await d.getFileHandle(m,{create:!0}),p=await f.createWritable();try{await p.write(s)}finally{await p.close()}return{savedPath:[...o,m].join("/")}},te=async e=>{let{rootDirHandle:t,nowPlayingPath:r,imageFile:l,reloadAfterSave:a=!0}=e;if(!t)throw Error("ãƒ•ã‚©ãƒ«ãƒ€ãŒæœªæŽ¥ç¶šã§ã™ï¼ˆæ¨©é™/å†æŽ¥ç¶šãŒå¿…è¦ï¼‰ã€‚");if(!r)throw Error("å†ç”Ÿä¸­ã®æ›²ãŒãªã„ãŸã‚ä¿å­˜ã—ã¾ã›ã‚“ã€‚");if(!l)throw Error("ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠžã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚");let i=await e7({rootDirHandle:t,nowPlayingPath:r,imageFile:l});return a&&window.location.reload(),i},tt=e=>!!e&&Array.from(e.types).includes("Files"),tr=e=>{if(null==e)return null;if("number"==typeof e)return Number.isFinite(e)?e:null;if("string"!=typeof e)return null;let t=e.trim();if(0===t.length)return null;let r=t.split("/")[0]?.trim()??"";if(!/^\d+$/.test(r))return null;let l=Number(r);return Number.isFinite(l)?l:null},tl=e=>{let t=tr(e.discNoRaw),r=tr(e.trackNoRaw);return null!=t||null!=r?1:2},ta=e=>[...e].sort((e,t)=>{let r=tl(e.t),l=tl(t.t);if(r!==l)return r-l;if(0===r){let r=tl(e.t),l=tl(t.t);return null!=r&&null!=l&&r!==l?r-l:null!=r!=(null!=l)?null!=r?-1:1:e.index-t.index}if(1===r){let r=tr(e.t.discNoRaw)??1,l=tr(t.t.discNoRaw)??1;if(r!==l)return r-l;let a=tr(e.t.trackNoRaw),i=tr(t.t.trackNoRaw);return null!=a&&null!=i&&a!==i?a-i:null!=a!=(null!=i)?null!=a?-1:1:e.index-t.index}let a=S(e.t.item.path).toLowerCase(),i=S(t.t.item.path).toLowerCase(),n=a.localeCompare(i,"ja");return 0!==n?n:e.index-t.index}),ti={fantia:0,tag:1,dir:2},tn=(e,t)=>{let r=e.duration,l=Math.min(Number.isFinite(r)&&r>0?r:1/0,Math.max(0,t)),a=e.fastSeek;"function"==typeof a?a(l):e.currentTime=l};function ts(){let e,{settings:l}=(0,i.useSettings)(),{audioRef:n,nowPlayingID:s,playEntry:o,stopAndClear:d}=(()=>{let e=(0,r.useRef)(null),[t,l]=(0,r.useState)(null),[a,i]=(0,r.useState)(0),n=(0,r.useRef)(null),s=async t=>{let r=e.current;if(!r)return;n.current&&(URL.revokeObjectURL(n.current),n.current=null);let a=await t.fileHandle.getFile(),s=URL.createObjectURL(a);n.current=s,l(s),i(t.id),r.src=s,r.load();try{await r.play()}catch{}},o=(0,r.useCallback)(()=>{let t=e.current;t&&(t.pause(),t.currentTime=0,t.removeAttribute("src"),t.load(),i(-1))},[]);return{audioRef:e,audioSrc:t,nowPlayingID:a,playEntry:s,stopAndClear:o}})(),{isPlaying:u}=function(e){let[t,l]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let t=e.current;if(!t)return;let r=()=>{l(!t.paused&&!t.ended)};return r(),t.addEventListener("play",r),t.addEventListener("pause",r),t.addEventListener("ended",r),()=>{t.removeEventListener("play",r),t.removeEventListener("pause",r),t.removeEventListener("ended",r)}},[e]),{isPlaying:t}}(n),{syncPositionStateAction:c}=function(e){let{audioRef:t,isPlaying:l,trackKey:a}=e,i=(0,r.useRef)(0),n=(0,r.useCallback)(e=>{if(!ev())return;let r=t.current;if(!r)return;if(e)i.current=0;else{let e=Date.now();if(e-i.current<250)return;i.current=e}let a=r.duration,n=r.currentTime,s=r.playbackRate;if(!Number.isFinite(a)||a<=0||!Number.isFinite(n)||n<0||!Number.isFinite(s)||s<=0)return;let o=l&&(()=>{if("undefined"==typeof navigator)return!1;let e=navigator.userAgent;return e.includes("Android")&&e.includes("Chrome/")})()?1e-100:s;try{navigator.mediaSession.setPositionState({duration:a,playbackRate:o,position:Math.min(a,Math.max(0,n))})}catch{}},[t,l]);(0,r.useEffect)(()=>{ex()&&(navigator.mediaSession.playbackState=l?"playing":"paused")},[l]),(0,r.useEffect)(()=>{if(!ev())return;let e=t.current;if(!e)return;let r=()=>n(!0),l=()=>n(!1),a=()=>n(!0),i=()=>n(!0),s=()=>n(!0),o=()=>n(!0);return e.addEventListener("loadedmetadata",r),e.addEventListener("timeupdate",l),e.addEventListener("seeking",a),e.addEventListener("seeked",a),e.addEventListener("ratechange",i),e.addEventListener("play",s),e.addEventListener("pause",o),n(!0),()=>{e.removeEventListener("loadedmetadata",r),e.removeEventListener("timeupdate",l),e.removeEventListener("seeking",a),e.removeEventListener("seeked",a),e.removeEventListener("ratechange",i),e.removeEventListener("play",s),e.removeEventListener("pause",o)}},[t,a,n]);let s=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(ev()){if(!l){null!==s.current&&(window.clearInterval(s.current),s.current=null);return}return null===s.current&&(s.current=window.setInterval(()=>{n(!1)},500)),()=>{null!==s.current&&(window.clearInterval(s.current),s.current=null)}}},[l,a,n]),{syncPositionStateAction:n}}({audioRef:n,isPlaying:u,trackKey:s}),m=(()=>{let e=new Map;for(let t of(e=>{let t=e.split(/\r?\n/),r=(t.find(e=>e.trim()&&!e.trim().startsWith("#"))??"").includes("	")?"	":",",l=[];for(let e of t){let t=em(e,r);t&&l.push(t)}return l})(ec))t.prefixId&&e.set(t.prefixId.toLowerCase(),t);return e})(),{mp3List:f,artworkUrlByPath:p,settingState:h,settingActions:y}=(()=>{let e,t,l,{track:a,revokeAll:i}=(e=(0,r.useRef)(new Set),t=(0,r.useCallback)(t=>(e.current.add(t),t),[]),l=(0,r.useCallback)(()=>{for(let t of e.current)URL.revokeObjectURL(t);e.current.clear()},[]),(0,r.useEffect)(()=>l,[l]),{track:t,revokeAll:l}),[n,s]=(0,r.useState)(""),[o,d]=(0,r.useState)(""),[u,c]=(0,r.useState)(null),[m,f]=(0,r.useState)(!1),[p,h]=(0,r.useState)([]),y=(0,r.useRef)(0),[g,w]=(0,r.useState)({}),b=(0,r.useRef)(0),[x,v]=(0,r.useState)({}),k=(0,r.useRef)(0),_=(0,r.useRef)(0),[j,A]=(0,r.useState)({}),N=(0,r.useCallback)(()=>{k.current+=1,b.current+=1,s(""),d(""),f(!1),h([]),w({}),v({}),A({}),i()},[i]),S=(0,r.useCallback)(async e=>{await eZ({handle:e,track:a,infoRunIdRef:y,dirArtworkRunIdRef:k,metaRunIdRef:b,lyricsRunIdRef:_,setFolderName:d,setMp3List:h,setMetaByPath:w,setArtworkUrlByPath:v})},[a]);(e=>{let{buildList:t,setSavedHandle:l,setFolderName:a,setNeedsReconnect:i,setErrorMessage:n}=e;(0,r.useEffect)(()=>{(async()=>{try{let e=await es();if(!e)return;l(e),a(e.name),await ed(e)?(await t(e),i(!1)):i(!0)}catch(e){n(e instanceof Error?e.message:String(e))}})()},[t,l,a,i,n])})({buildList:S,setSavedHandle:c,setFolderName:d,setNeedsReconnect:f,setErrorMessage:s}),(0,r.useEffect)(()=>()=>{k.current+=1,b.current+=1,i()},[i]),function(e){let{mp3List:t,metaByPath:l,lyricsRunIdRef:a,setMetaByPathAction:i}=e,n=(0,r.useRef)(new Set);(0,r.useEffect)(()=>{if(!Array.isArray(t)||0===t.length)return;let e=++a.current,r=!1;return(async()=>{for(let s of t){if(r||a.current!==e)return;let t=s.path;if(!t||n.current.has(t))continue;let o=l[t];if(!o)continue;if("string"==typeof o.lyrics&&o.lyrics.trim()){n.current.add(t);continue}let d=o.title+t,u=await ey(d);u&&(n.current.add(t),i(e=>{let r=e[t];return!r||"string"==typeof r.lyrics&&r.lyrics.trim()?e:{...e,[t]:{...r,lyrics:u}}}))}})(),()=>{r=!0}},[t,l,a,i,n])}({mp3List:p,metaByPath:g,lyricsRunIdRef:_,setMetaByPathAction:w});let T=(0,r.useCallback)(async()=>{await eX({resetView:N,buildList:S,setNeedsReconnect:f,setSavedHandle:c,setErrorMessage:s})},[N,S]),L=(0,r.useCallback)(async()=>{await e0({savedHandle:u,resetView:N,buildList:S,setNeedsReconnect:f,setErrorMessage:s})},[u,N,S]),I=(0,r.useCallback)(async()=>{await e1({resetView:N,setSavedHandle:c,setNeedsReconnect:f})},[N]),P=(0,r.useMemo)(()=>(e=>{let{folderName:t,errorMessage:r,metaByPath:l,savedHandle:a,needsReconnect:i}=e;return{folderName:t,errorMessage:r,metaByPath:l,savedHandle:a,needsReconnect:i}})({folderName:o,errorMessage:n,metaByPath:g,savedHandle:u,needsReconnect:m}),[o,n,g,u,m]),B=(0,r.useMemo)(()=>Array.isArray(p)&&0!==p.length?(e=>{let{mp3List:t,dirArtworkUrlByDir:r}=e;if(!Array.isArray(t)||0===t.length)return[];let l=new Map;for(let e of t){let t=C(e.path),r=l.get(t)??[];r.push(e.path),l.set(t,r)}return Array.from(l.entries()).map(([e,t])=>{let l=r[e]??null;return{key:`dir:${e}`,kind:"dir",dirKey:e,trackPaths:t,dirArtworkUrl:l}})})({mp3List:p,dirArtworkUrlByDir:x}):[],[p,x]);return{mp3List:p,artworkUrlByPath:x,settingState:P,settingActions:{pickFolderAndLoad:T,reconnect:L,forget:I},fantiaEntryByPath:j,albums:B}})(),g=(e=>{let{mp3List:t,metaByPath:l,artworkUrlByPath:a,mappingByPrefixId:i}=e;return r.default.useMemo(()=>t.map((e,t)=>{let r=l[e.path],n=eJ(e.path),s=n?i.get(n)??null:null,o=s?.title?.trim()||r?.title?.trim()||e.fileHandle.name,d=s?.originalArtist?.trim()||r?.artist?.trim()||"",u=s?.albumTitle?.trim()||((...e)=>{for(let t of e){let e="string"==typeof t?t.trim():"";if(e.length>0)return e}return null})(r?.album),c=n?i.get(n):void 0,m=s?.albumTitle??r?.album??null,f=e3(r?.artist),p=e3(c?.originalArtist),h=C(e.path),y=a[e.path]??a[h]??null;return{item:e,index:t,display:{title:o,artist:d,albumTitle:u},displayTitle:o,originalArtist:p??f,artworkUrl:y,trackNoRaw:c?.track??e9(r?.trackNo??null),discNoRaw:e9(r?.discNo??r?.diskNo??null),albumTitle:m,lyrics:r?.lyrics??null,lyricsLrc:r?.lyricsLrc??null}}),[t,l,i,a])})({mp3List:f,metaByPath:h.metaByPath,artworkUrlByPath:p,mappingByPrefixId:m}),w=r.default.useMemo(()=>(e=>{let{trackViews:t,folderName:r,dirArtworkUrlByDir:l}=e;if(0===t.length)return[];let a=t.map((e,t)=>({t:e,index:t})),i=new Map;for(let e of a){let t=e.t.albumTitle?.replace(/\u0000/g,"").replace(/\s+/g," ").trim()??"";if(t.length>0){let r=`tag:${t.toLowerCase()}`,l=i.get(r);l?l.rows.push(e):i.set(r,{kind:"tag",title:t,dirKey:"",rows:[e]});continue}let l=C(e.t.item.path),a=l.length>0?l:`${r}æœªåˆ†é¡ž`,n=`dir:${l}`,s=i.get(n);s?s.rows.push(e):i.set(n,{kind:"dir",title:a,dirKey:l,rows:[e]})}let n=[];for(let e of i.values()){let t=ta(e.rows),r=("dir"===e.kind?l[e.dirKey]??null:null)??t[0]?.t.artworkUrl??null;n.push({key:`${e.kind}:${e.title}`,kind:e.kind,dirPath:e.dirKey,title:e.title,trackCount:t.length,artworkUrl:r,tracks:t})}return n.sort((e,t)=>{let r=e.key.startsWith("fantia:")?"fantia":e.key.startsWith("tag:")?"tag":"dir",l=t.key.startsWith("fantia:")?"fantia":t.key.startsWith("tag:")?"tag":"dir",a=ti[r]-ti[l];return 0!==a?a:e.title.localeCompare(t.title,"ja")}),n})({trackViews:g,folderName:h.folderName,dirArtworkUrlByDir:p}),[g,h.folderName,p]),x=r.default.useMemo(()=>{let e=w.map(e=>{let t=ta(e.tracks);return{...e,tracks:t,trackCount:t.length}});return e.sort((e,t)=>e.title.localeCompare(t.title,"ja")),e},[w]),v=(e=>{let{audioRef:t,playEntry:l,trackViews:a,resetKey:i,settings:n,stopAndClear:s,albumViews:o}=e,d=(0,r.useRef)(null),u=(0,r.useRef)(!0),c=(0,r.useRef)(!1);(0,r.useEffect)(()=>{u.current=n.playback.continuous,c.current=n.playback.shuffle},[n.playback.continuous,n.playback.shuffle]);let m=!!(n.ui.showAlbums&&o&&o.length>0),f=(0,r.useMemo)(()=>{if(m&&o){let e=[...o];return(n.playback.shuffle?e2(e):e).flatMap(e=>e.tracks.map(e=>e.index))}let e=a.map((e,t)=>t);return n.playback.shuffle?e2(e):e},[m,o,n.playback.shuffle,a]),p=(0,r.useCallback)(async e=>{if(e<0||e>=a.length)return;let t=a[e],r=t.item.name;d.current=e,await l(t.item,r)},[a,l]),h=(0,r.useCallback)(async()=>{let e=d.current;if(null===e){let e=f[0];void 0!==e&&await p(e);return}let t=f.indexOf(e),r=t>=0?f[t+1]:f[0];void 0!==r&&await p(r)},[p,f]),y=(0,r.useCallback)(async()=>{let e=d.current;if(null===e){let e=f[f.length-1];void 0!==e&&await p(e);return}let t=f.indexOf(e),r=t>0?f[t-1]:f[f.length-1];void 0!==r&&await p(r)},[p,f]),g=r.default.useCallback(()=>{let e=t.current;e&&e.play()},[t]),w=(0,r.useCallback)(async()=>{s?.()},[s]),b=(0,r.useCallback)(async()=>{let e=t.current;e&&e.pause()},[t]);return(0,r.useEffect)(()=>{let e=t.current;if(!e)return;let r=()=>{u.current&&h()};return e.addEventListener("ended",r),()=>e.removeEventListener("ended",r)},[t,h]),(0,r.useEffect)(()=>{void 0!==i&&(d.current=null,s?.())},[i,s]),(0,r.useEffect)(()=>{let e=e=>{if((e=>{if(!(e instanceof HTMLElement))return!1;let t=e.tagName.toLowerCase();return"input"===t||"textarea"===t||"select"===t||e.isContentEditable})(e.target)||e.ctrlKey||e.metaKey||e.altKey||e.repeat)return;let r=t.current;if(r){if("Space"===e.code)return(e.preventDefault(),r.paused)?(r.src||(p(0),r.load()),void r.play().catch(()=>{})):void r.pause();if("ArrowDown"===e.code){e.preventDefault(),h();return}if("ArrowUp"===e.code){e.preventDefault(),y();return}if("ArrowLeft"===e.code){e.preventDefault(),e5(r,-10);return}if("ArrowRight"===e.code){e.preventDefault(),e5(r,10);return}}};return window.addEventListener("keydown",e,{passive:!1}),()=>window.removeEventListener("keydown",e)},[t,a.length,p,h,y]),(0,r.useMemo)(()=>({playActions:{playAtIndex:p,playNext:h,playPrev:y,play:g,stop:w,pause:b}}),[b,g,p,h,y,w])})({audioRef:n,playEntry:o,trackViews:g,resetKey:h.folderName,settings:l,albumViews:x,stopAndClear:d});!function(e){let{trackViews:t,nowPlayingID:l,playAction:a,pauseAction:i,nextAction:n,prevAction:s,audioRef:o,syncPositionStateAction:d}=e;(0,r.useEffect)(()=>{if(!eg())return;navigator.mediaSession.setActionHandler("play",a),navigator.mediaSession.setActionHandler("pause",i),navigator.mediaSession.setActionHandler("nexttrack",n),navigator.mediaSession.setActionHandler("previoustrack",s);let e=e=>{let t=o.current;if(!t)return;let r=eb(t.duration,0),l=eb(t.currentTime,0);t.currentTime=r>0?ew(l+e,0,r):Math.max(l+e,0),d(!0)};return navigator.mediaSession.setActionHandler("seekbackward",t=>{e(-(t?.seekOffset??10))}),navigator.mediaSession.setActionHandler("seekforward",t=>{e(t?.seekOffset??10)}),navigator.mediaSession.setActionHandler("seekto",e=>{let t=o.current;if(!t)return;let r=e?.seekTime;if("number"!=typeof r||!Number.isFinite(r)||r<0)return;let l=eb(t.duration,0),a=l>0?ew(r,0,l):r;e?.fastSeek&&"function"==typeof t.fastSeek?t.fastSeek(a):t.currentTime=a,d(!0)}),()=>{navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("nexttrack",null),navigator.mediaSession.setActionHandler("previoustrack",null),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("seekto",null)}},[a,i,n,s,o,d]),(0,r.useEffect)(()=>{if(!eg()||null==l)return;let e=t.find(e=>e.item.id===l);if(!e)return;let r=e.artworkUrl??"";navigator.mediaSession.metadata=new MediaMetadata({title:e.displayTitle??"",artist:e.originalArtist??"",album:e.albumTitle??"",artwork:r?[{src:r,sizes:"512x512"},{src:r,sizes:"256x256"},{src:r,sizes:"96x96"}]:void 0})},[t,l])}({trackViews:g,nowPlayingID:s,playAction:v.playActions.play,pauseAction:v.playActions.pause,nextAction:v.playActions.playNext,prevAction:v.playActions.playPrev,audioRef:n,syncPositionStateAction:c});let j=(e=>{let{audioRef:t,playActions:l,settingActions:a}=e,i=r.useCallback(()=>{if(l?.stop)return void l.stop();let e=t.current;e&&(e.pause(),e.currentTime=0,e.src="")},[l,t]),n=r.useCallback(()=>{let e=t.current;if(!e)return;let r=e.currentTime-10;tn(e,r)},[t]),s=r.useCallback(()=>{let e=t.current;if(!e)return;let r=e.currentTime+10;tn(e,r)},[t]),o=r.useCallback(async()=>{i(),await a.pickFolderAndLoad()},[i,a]),d=r.useCallback(async()=>{i(),await a.reconnect()},[i,a]),u=r.useCallback(async()=>{i(),await a.forget()},[i,a]);return r.useMemo(()=>({stopPlayback:i,pickFolder:o,reconnect:d,forget:u,playPrev:l?.playPrev??(async()=>{}),playNext:l?.playNext??(async()=>{}),playRewind:n,playForward:s,playAtIndex:l?.playAtIndex??(async()=>{})}),[i,o,d,u,l?.playPrev,l?.playNext,l?.playAtIndex,n,s])})({audioRef:n,playActions:v.playActions,settingActions:y}),A=r.default.useMemo(()=>{if(!s)return null;let e=f.find(e=>e.id===s);return e?.path??null},[f,s]),{isDragging:N}=(e=>{let{isWindows:t,rootDirHandle:l,nowPlayingPath:a,onSavedAction:i,onErrorAction:n}=e,[s,o]=r.default.useState(!1),d=r.default.useRef(0);return(r.default.useEffect(()=>{let e=e=>{tt(e.dataTransfer)&&(e.preventDefault(),d.current+=1,o(!0))},t=e=>{tt(e.dataTransfer)&&e.preventDefault()},r=e=>{tt(e.dataTransfer)&&(e.preventDefault(),d.current=Math.max(0,d.current-1),0===d.current&&o(!1))},s=async e=>{if(!tt(e.dataTransfer))return;if(e.preventDefault(),d.current=0,o(!1),!a)return void n?.("å†ç”Ÿä¸­ã®æ›²ãŒãªã„ãŸã‚ä¿å­˜ã—ã¾ã›ã‚“ã€‚");if(!l)return void n?.("ãƒ•ã‚©ãƒ«ãƒ€ãŒæœªæŽ¥ç¶šã§ã™ï¼ˆæ¨©é™/å†æŽ¥ç¶šãŒå¿…è¦ï¼‰ã€‚");let t=e.dataTransfer;if(!t)return;let r=Array.from(t.files);if(1!==r.length)return void n?.("ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã¯1ã¤ã ã‘ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚");let s=r[0]??null;try{let e=await te({rootDirHandle:l,nowPlayingPath:a,imageFile:s,reloadAfterSave:!0});i?.(e.savedPath)}catch(t){let e=t instanceof Error?t.message:"ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚";n?.(e)}};return window.addEventListener("dragenter",e),window.addEventListener("dragover",t),window.addEventListener("dragleave",r),window.addEventListener("drop",s),()=>{window.removeEventListener("dragenter",e),window.removeEventListener("dragover",t),window.removeEventListener("dragleave",r),window.removeEventListener("drop",s)}},[l,a,i,n]),t)?{isDragging:s}:{isDragging:!1}})({isWindows:(e=navigator,!!(e.userAgentData?.platform??"").toLowerCase().includes("windows")||(navigator.userAgent??"").toLowerCase().includes("windows")),rootDirHandle:h.savedHandle??null,nowPlayingPath:A,onSavedAction:e=>{console.log("saved:",e),window.location.reload()},onErrorAction:e=>{console.warn(e)}});return(0,t.jsxs)(t.Fragment,{children:[N?(0,t.jsx)("div",{"aria-hidden":!0,style:{position:"fixed",inset:12,borderRadius:20,outline:"2px dashed rgba(0,0,0,0.25)",background:"rgba(0,0,0,0.05)",display:"grid",placeItems:"center",pointerEvents:"none",zIndex:9999,fontSize:14},children:"ç”»åƒã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ã¨ä¿å­˜ã—ã¾ã™"}):null,(0,t.jsx)(a,{header:(0,t.jsx)(k,{title:_.appMeta.name,folderName:h.folderName}),sidebar:({closeSidebar:e})=>(0,t.jsx)(b,{state:h,commands:j,closeSidebar:e}),main:(0,t.jsxs)(t.Fragment,{children:[h.errorMessage?(0,t.jsxs)("p",{style:{color:"crimson"},children:["ã‚¨ãƒ©ãƒ¼: ",h.errorMessage]}):null,h.needsReconnect?(0,t.jsx)("p",{style:{opacity:.7},children:"ãƒ•ã‚©ãƒ«ãƒ€ã¸ã®å†æŽ¥ç¶šãŒå¿…è¦ã§ã™ï¼ˆæ¨©é™ï¼‰ã€‚"}):null,(0,t.jsx)(q,{albums:w,trackViews:g,nowPlayingID:s,isPlaying:u,state:h,commands:j})]}),renderPlayer:e=>(0,t.jsx)(H,{variant:e,nowPlayingID:s,trackViews:g,albumViews:x,audioRef:n,commands:j,isPlaying:u,metaByPath:h.metaByPath})})]})}e.s(["default",()=>ts],52683)}]);